(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var U=Object.create,_=Object.defineProperty,$=Object.defineProperties,D=Object.getOwnPropertyDescriptor,T=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,V=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable,Z=(e,t,a)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,d=(e,t)=>{for(var a in t=t||{})H.call(t,a)&&Z(e,a,t[a]);if(F)for(var a of F(t))q.call(t,a)&&Z(e,a,t[a]);return e},u=(e,t)=>$(e,T(t)),W=(e,t)=>{var a={};for(n in e)H.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&F)for(var n of F(e))t.indexOf(n)<0&&q.call(e,n)&&(a[n]=e[n]);return a},e=(e,t,a)=>(a=null!=e?U(V(e)):{},((t,a,n,r)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let e of z(a))H.call(t,e)||e===n||_(t,e,{get:()=>a[e],enumerable:!(r=D(a,e))||r.enumerable});return t})(!t&&e&&e.__esModule?a:_(a,"default",{value:e,enumerable:!0}),e)),t=(G=(e,t)=>function(){return t||(0,e[z(e)[0]])((t={exports:{}}).exports,t),t.exports})({"external-global-plugin:react"(e,t){t.exports=Spicetify.React}}),J=G({"../node_modules/canvas/lib/parse-font.js"(e,t){var a=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,r=new RegExp("(bold|bolder|lighter|[1-9]00) +","i"),l=new RegExp("(italic|oblique) +","i"),i=new RegExp("(small-caps) +","i"),o=new RegExp("(ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded) +","i"),s=new RegExp(`([\\d\\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q) *((?:${a})( *, *(?:${a}))*)`),c={};t.exports=e=>{if(c[e])return c[e];var t=s.exec(e);if(t){var a,n={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(t[1]),unit:t[2],family:t[3].replace(/["']/g,"").replace(/ *, */g,",")},t=e.substring(0,t.index);switch((a=r.exec(t))&&(n.weight=a[1]),(a=l.exec(t))&&(n.style=a[1]),(a=i.exec(t))&&(n.variant=a[1]),(a=o.exec(t))&&(n.stretch=a[1]),n.unit){case"pt":n.size/=.75;break;case"pc":n.size*=16;break;case"in":n.size*=96;break;case"cm":n.size*=96/2.54;break;case"mm":n.size*=96/25.4;break;case"%":break;case"em":case"rem":n.size*=16/.75;break;case"q":n.size*=96/25.4/4}return c[e]=n}}}}),G=G({"../node_modules/canvas/browser.js"(e){var t=J();e.parseFont=t,e.createCanvas=function(e,t){return Object.assign(document.createElement("canvas"),{width:e,height:t})},e.createImageData=function(e,t,a){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(e);case 2:return new ImageData(e,t);default:return new ImageData(e,t,a)}},e.loadImage=function(r,l){return new Promise(function(e,t){let a=Object.assign(document.createElement("img"),l);function n(){a.onload=null,a.onerror=null}a.onload=function(){n(),e(a)},a.onerror=function(){n(),t(new Error('Failed to load the image "'+r+'"'))},a.src=r})}}}),l=e(t()),X=(0,l.memo)(({title:e,children:t,headingChild:a,onClose:n,isOpen:r=!1})=>r?l.default.createElement("div",{className:"modal-container"},l.default.createElement("div",{className:"modal-overlay "+(r&&"open"),style:{zIndex:20},onClick:n}),l.default.createElement("dialog",{open:r,className:"modal-section "+(r&&"open"),"aria-label":e,"aria-modal":"true"},l.default.createElement("div",{className:"main-embedWidgetGenerator-container"},l.default.createElement("div",{className:"main-trackCreditsModal-header"},l.default.createElement("h1",{className:"encore-text encore-title-body-medium"},e),a&&l.default.createElement("div",null,a),l.default.createElement("button",{type:"button","aria-label":"Close",className:"main-trackCreditsModal-closeBtn",onClick:()=>n()},l.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},l.default.createElement("title",null,"Close"),l.default.createElement("path",{d:"M31.098 29.794L16.955 15.65 31.097 1.51 29.683.093 15.54 14.237 1.4.094-.016 1.508 14.126 15.65-.016 29.795l1.414 1.414L15.54 17.065l14.144 14.143",fill:"currentColor","fill-rule":"evenodd"})))),l.default.createElement("div",{className:"modal-contents"},l.default.createElement("main",{className:"modal-wrapper"},t))))):null),Q=e(t()),j=({title:e,description:t,children:a})=>Q.default.createElement("div",{className:"setting-section"},Q.default.createElement("div",{className:"heading-wrapper"},Q.default.createElement("h3",{className:"title encore-text encore-text-title-small"},e),t&&Q.default.createElement("p",{className:"desc encore-text encore-text-body-small"},t)),a),Y=[{label:"Animated",value:"animated"},{label:"Static",value:"static"},{label:"Solid",value:"solid"}],K=[{label:"Compact",value:"compact"},{label:"Default",value:"default"},{label:"Rounded",value:"rounded"}],ee=[{label:"Starry",value:"starry"},{label:"Default",value:"default"},{label:"none",value:"none"}],te=[{label:"Now Playing",value:"now-playing"},{label:"Playlist Cover",value:"inherit"},{label:"none",value:"none"}],ae=[{label:"Card",value:"card"},{label:"Compact Card",value:"compact-card"},{label:"Compact",value:"compact"},{label:"Default",value:"default"}],ne=[{label:"None",value:"none"},{label:"Hidden",value:"hidden"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Solid",value:"solid"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}],re=[{label:"Profile Context Menu",value:"context-menu"},{label:"Global Nav",value:"nav"}],le=[{label:"Compact",value:"compact"},{label:"Normal",value:"normal"}],ie=[{label:"Left",value:"left"},{label:"Right",value:"right"}],oe=e(t()),se=()=>oe.default.createElement("svg",{role:"img","aria-label":"dismiss",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},oe.default.createElement("path",{d:"m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z",fill:"#ffffff"})),ce=e(t()),o=e=>{var{variant:t="primary",size:a="medium",icon:n,children:r}=e,e=W(e,["variant","size","icon","children"]);return ce.default.createElement("button",d({className:`button button-${t} button-`+a},e),n&&ce.default.createElement("span",{className:"button-icon"},n),r)},n=e(t()),de=0,{ToastContainer:ue,addToast:y}=(()=>{let a;return{ToastContainer:()=>{let[e,r]=(0,n.useState)([]);var t=(0,n.useCallback)((t,a=!1)=>{let n=de++,e=(r(e=>[...e,{id:n,message:t,isError:a,exiting:!1}]),setTimeout(()=>{l(n)},3e3));return()=>clearTimeout(e)},[]);a=t;let l=t=>{r(e=>e.map(e=>e.id===t?u(d({},e),{exiting:!0}):e)),setTimeout(()=>{r(e=>e.filter(e=>e.id!==t))},500)};return n.default.createElement("div",{className:"toast-container"},e.map(e=>n.default.createElement("div",{key:e.id,className:"toast-element "+(e.exiting?"toast-exit":""),style:{backgroundColor:e.isError?"rgba(200,20,20,0.5)":"rgba(20,20,20,0.5)"}},e.message,n.default.createElement(o,{icon:n.default.createElement(se,null),onClick:()=>l(e.id)}))))},addToast:(e,t)=>a(e,t)}})(),me=e=>{let n,r=new Set;var t=(e,a)=>{e="function"==typeof e?e(n):e;if(!Object.is(e,n)){let t=n;n=(null!=a?a:"object"!=typeof e||null===e)?e:Object.assign({},n,e),r.forEach(e=>e(n,t))}},a=()=>n,l={setState:t,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))};let i=n=e(t,a,l);return l},ge=e=>e?me(e):me,pe=e(t(),1),fe=e=>e,be=e=>{let n=ge(e);e=e=>{return[t,a=fe]=[n,e],e=pe.default.useSyncExternalStore(t.subscribe,()=>a(t.getState()),()=>a(t.getInitialState())),pe.default.useDebugValue(e),e;var t,a};return Object.assign(e,n),e},ye=a=>e=>{try{let t=a(e);return t instanceof Promise?t:{then(e){return ye(e)(t)},catch(e){return this}}}catch(t){return{then(e){return this},catch(e){return ye(e)(t)}}}},ve={isUseLocalImage:!1,selectedLocalImage:null},he=(bt=e=>e?be(e):be)((E=(g,p)=>(a,n,e)=>{let r={storage:((e,a)=>{let n;try{n=e()}catch(e){return}return{getItem:e=>{var t=e=>null===e?null:JSON.parse(e,null==a?void 0:a.reviver),e=null!=(e=n.getItem(e))?e:null;return e instanceof Promise?e.then(t):t(e)},setItem:(e,t)=>n.setItem(e,JSON.stringify(t,null==a?void 0:a.replacer)),removeItem:e=>n.removeItem(e)}})(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...p},l=!1,i=new Set,o=new Set,s=r.storage;if(!s)return g((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),a(...e)},n,e);let c=()=>{var e=r.partialize({...n()});return s.setItem(r.name,{state:e,version:r.version})},d=e.setState,u=(e.setState=(e,t)=>{d(e,t),c()},g((...e)=>{a(...e),c()},n,e));e.getInitialState=()=>u;let m,t=()=>{var e;if(s){l=!1,i.forEach(e=>e(null!=(e=n())?e:u));let t=(null==(e=r.onRehydrateStorage)?void 0:e.call(r,null!=(e=n())?e:u))||void 0;return ye(s.getItem.bind(s))(r.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===r.version)return[!1,e.state];if(r.migrate)return[!0,r.migrate(e.state,e.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var[e,t]=e;if(m=r.merge(t,null!=(t=n())?t:u),a(m,!0),e)return c()}).then(()=>{null!=t&&t(m,void 0),m=n(),l=!0,o.forEach(e=>e(m))}).catch(e=>{null!=t&&t(void 0,e)})}};return e.persist={setOptions:e=>{r={...r,...e},e.storage&&(s=e.storage)},clearStorage:()=>{null!=s&&s.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>t(),hasHydrated:()=>l,onHydrate:e=>(i.add(e),()=>{i.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},r.skipHydration||t(),m||u})(t=>u(d({},ve),{setUseLocalImage:e=>t(()=>({isUseLocalImage:e})),setSelectedLocalImage:e=>t(()=>({selectedLocalImage:e})),clearSelectedLocalImage:()=>t(()=>d({},ve))}),{name:"lucid-bg-image"})),Se={backgroundSettings:{mode:"static",styles:{solid:{opacity:1,backgroundColor:"var(--spice-main)"},static:{blur:32,opacity:1,saturation:1.1,contrast:1.2,brightness:.5},animated:{blur:32,time:45,opacity:1,saturation:1.1,contrast:1.2,brightness:.475}},customBackgroundOverride:{url:null}},interfaceSettings:{controlSettings:{height:64},fontSettings:{body:{url:"https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap",fontFamily:"Poppins"}},grainSettings:{grainEffect:"default"},pagesSettings:{isScrollMode:!1,backgroundImageMode:"inherit",playlistViewMode:"card"},borderSettings:{color:"rgba(var(--spice-rgb-selected-row, var(--spice-rgb-text)), 0.125)",style:"inset",thickness:1,roundedRadius:12}},npvSettings:{mode:"normal",position:"right",blur:24},colorSettings:{isDynamicColor:!1},playbarSettings:{mode:"default",styles:{compact:{height:64,opacity:1,saturation:1.1,contrast:1.2,brightness:.8,borderRadius:8,backdropBlur:32,paddingX:6,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"},default:{height:80,opacity:1,paddingX:6,saturation:1.1,contrast:1.2,borderRadius:8,brightness:.8,backdropBlur:32,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"},rounded:{height:80,opacity:1,paddingX:20,saturation:1.1,contrast:1.2,borderRadius:999,brightness:.8,backdropBlur:32,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"}}},settingAccessPosition:"context-menu"},O=bt(E((r,t)=>u(d({},Se),{exportSettings:()=>{var e=t();return JSON.stringify(e)},importSettings:t=>{try{var e=JSON.parse(t);if("object"==typeof(a=e)&&null!==a&&"backgroundSettings"in a&&"interfaceSettings"in a&&"playbarSettings"in a&&"colorSettings"in a&&"object"==typeof a.backgroundSettings&&"mode"in a.backgroundSettings&&"styles"in a.backgroundSettings&&"object"==typeof a.interfaceSettings&&"borderSettings"in a.interfaceSettings&&"fontSettings"in a.interfaceSettings&&"object"==typeof a.playbarSettings&&"mode"in a.playbarSettings&&"object"==typeof a.colorSettings&&"isDynamicColor"in a.colorSettings)return r(e),y("Settings imported successfully!"),!0;throw new Error("Invalid settings structure")}catch(e){t=e instanceof SyntaxError?"Failed to parse JSON: Please ensure your input is valid JSON.":e instanceof Error?e.message:"An unknown error occurred.";return y(t,!0),!1}var a},setBackgroundSettings:t=>r(e=>({backgroundSettings:d(d({},e.backgroundSettings),t)})),setNpvMode:t=>r(e=>({npvSettings:u(d({},e.npvSettings),{mode:t})})),setNpvBlur:t=>r(e=>({npvSettings:u(d({},e.npvSettings),{blur:t})})),setCompactNpvPosition:t=>r(e=>({npvSettings:u(d({},e.npvSettings),{position:t})})),setSettingAccessPosition:e=>r(()=>({settingAccessPosition:e})),setControlHeight:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{controlSettings:{height:t}})})),setCustomBackgroundOverride:t=>r(e=>({backgroundSettings:u(d({},e.backgroundSettings),{customBackgroundOverride:u(d({},e.backgroundSettings.customBackgroundOverride),{url:t})})})),setBorderColor:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{borderSettings:u(d({},e.interfaceSettings.borderSettings),{color:t})})})),setBorderStyle:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{borderSettings:u(d({},e.interfaceSettings.borderSettings),{style:t})})})),setRoundedBorderRadius:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{borderSettings:u(d({},e.interfaceSettings.borderSettings),{roundedRadius:t})})})),setBorderThickness:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{borderSettings:u(d({},e.interfaceSettings.borderSettings),{thickness:t})})})),setBackgroundStyles:(t,a)=>r(e=>({backgroundSettings:u(d({},e.backgroundSettings),{styles:u(d({},e.backgroundSettings.styles),{[a]:d(d({},e.backgroundSettings.styles[a]),t)})})})),setColorSettings:t=>r(e=>({colorSettings:d(d({},e.colorSettings),t)})),setBorderSettings:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{borderSettings:d(d({},e.interfaceSettings.borderSettings),t)})})),setPlaybarSettings:t=>r(e=>({playbarSettings:d(d({},e.playbarSettings),t)})),setInterfaceSettings:t=>r(e=>({interfaceSettings:d(d({},e.interfaceSettings),t)})),setBackgroundMode:t=>r(e=>({backgroundSettings:u(d({},e.backgroundSettings),{mode:t})})),updateBackgroundStyle:(t,a,n)=>r(e=>({backgroundSettings:u(d({},e.backgroundSettings),{styles:u(d({},e.backgroundSettings.styles),{[t]:u(d({},e.backgroundSettings.styles[t]),{[a]:n})})})})),setFont:(t,a)=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{fontSettings:u(d({},e.interfaceSettings.fontSettings),{[t]:d({},a)})})})),setGrainEffect:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{grainSettings:u(d({},e.interfaceSettings.grainSettings),{grainEffect:t})})})),setIsScrollMode:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{pagesSettings:u(d({},e.interfaceSettings.pagesSettings),{isScrollMode:t})})})),setPagesBackgroundImageMode:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{pagesSettings:u(d({},e.interfaceSettings.pagesSettings),{backgroundImageMode:t})})})),setPlaylistViewMode:t=>r(e=>({interfaceSettings:u(d({},e.interfaceSettings),{pagesSettings:u(d({},e.interfaceSettings.pagesSettings),{playlistViewMode:t})})})),setIsDynamicColor:t=>r(e=>({colorSettings:u(d({},e.colorSettings),{isDynamicColor:t})})),updatePlaybarStyle:(t,a,n)=>r(e=>({playbarSettings:u(d({},e.playbarSettings),{styles:u(d({},e.playbarSettings.styles),{[t]:u(d({},e.playbarSettings.styles[t]),{[a]:n})})})})),setPlaybarMode:t=>r(e=>({playbarSettings:u(d({},e.playbarSettings),{mode:t})})),resetAllSettings:()=>{r(Se)}}),{name:"lucid-settings",version:1.1,migrate:e=>d(d({},Se),e)})),we=e=>{try{return new URL(e),!0}catch(e){return!1}},Ee=e=>decodeURIComponent((null==(e=null==(e=e.match(/family=([^&:]+)/))?void 0:e[1])?void 0:e.replace(/\+/g," "))||"")||"",ke=(e,a,n)=>Object.entries(e[a]).map(([t,e])=>({id:"style-"+a,sectionName:"Styles",conditionalRender:!0,cardProps:{title:"Set "+t,type:"input",settings:d({label:"",defaultValue:e},"number"==typeof e?{type:"number",onChange:e=>{n(a,t,Number(e))},settings:{max:256,min:0,step:.5}}:{type:"text",onChange:e=>{n(a,t,e)}})}})),xe=console.log,Re=console.debug,Pe=console.error,Ce=console.warn,Le={prefix:"font-weight: bold; color: #4DB6AC; font-size: 0.85rem;",error:"color: #dc3545;",warn:"color: #ffc107;",debug:"color: #17a2b8;",info:""},Ne=(e,t,...a)=>{var n={info:xe,debug:Re,error:Pe,warn:Ce}[e],e=Le[e];n("%c[Lucid] %c"+t,Le.prefix,e,...a)},c=(e,...t)=>Ne("info",e,...t),b=(e,...t)=>Ne("debug",e,...t),w=(e,...t)=>Ne("error",e,...t),Ie=(e,...t)=>Ne("warn",e,...t),a=e(t()),Me=({children:e})=>a.default.createElement("div",{className:"tooltip-container"},a.default.createElement("div",{className:"tooltip"},a.default.createElement("span",{className:"tooltip-icon"},a.default.createElement("svg",{role:"img","aria-label":"Tooltip icon",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},a.default.createElement("path",{d:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z",fill:"currentColor"}))),a.default.createElement("span",{className:"tooltip-content"},e))),r=e(t()),Be=({title:e,tooltip:t,selectedValue:a})=>r.default.createElement("div",{className:"title-container"},r.default.createElement("div",{className:"title-wrapper"},e&&r.default.createElement("h5",{className:"encore-text encore-text-body-medium-bold"},e),t&&r.default.createElement(Me,null,t)),a&&r.default.createElement("p",{className:"selected-value"},"Selected: ",a)),Ue=e(t()),_e=()=>Ue.default.createElement("svg",{role:"img","aria-label":"Arrow Down",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ue.default.createElement("path",{d:"M4.293 8.293a1 1 0 0 1 1.414 0L12 14.586l6.293-6.293a1 1 0 1 1 1.414 1.414l-7 7a1 1 0 0 1-1.414 0l-7-7a1 1 0 0 1 0-1.414Z",fill:"#ffffff"})),m=e(t()),je=({options:e,selectedValue:a,onChange:t,placeholder:n,disabled:r})=>{let l=(0,m.useRef)(null),[i,o]=(0,m.useState)(!1);let s=e=>{o(!1),t(e)};return(0,m.useEffect)(()=>{let e=e=>{l.current&&!l.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"dropdown-container",ref:l},m.default.createElement("button",{className:"dropdown-button "+(i?"open":""),onClick:()=>{o(e=>!e)},"aria-label":"Toggle dropdown menu",type:"button"},m.default.createElement("p",{className:"encore-text"},n||a||"Dropdown"),m.default.createElement("span",{className:"dropdown-arrow"},m.default.createElement(_e,null))),m.default.createElement("div",{className:"dropdown-menu "+(i?"open":"")},i?null==e?void 0:e.map(t=>m.default.createElement("li",{key:t.value,className:"dropdown-item "+(a===t.value?"selected":""),onClick:()=>!t.disabled&&s(t.value),onKeyDown:e=>!t.disabled&&"Enter"===e.key&&s(t.value),style:{opacity:""+(r?.75:1)}},m.default.createElement("p",{className:"encore-text"},t.label))):null)))},v=e(t()),Oe=(0,v.forwardRef)(({label:e,defaultValue:t,onChange:r,type:a,placeholder:n,settings:l},i)=>{let o,s,c,[d,u]=(0,v.useState)(t||null),[m,g]=(0,v.useState)(null),p="file"===a,f="number"===a,b=(0,v.useMemo)(()=>((t,a)=>{let n=null;return(...e)=>{n&&clearTimeout(n),n=setTimeout(()=>{t(...e)},a)}})(e=>{p||null!=r&&r(e)},1e3),[r]);t=(0,v.useCallback)(e=>{var t,a,n;p?(a=e.target.files,null!=r&&r(a)):f&&l?(a=Number(e.target.value),t=null!=(t=l.max)?t:100,n=null!=(n=l.min)?n:0,t<a?g("Value cannot exceed "+t):a<n?g("Value cannot be less than "+n):g(null),a=Math.min(Math.max(a,n),t).toString(),u(a),b(a)):(n=e.target.value,u(n),g(null),b(n))},[b,l]);return(0,v.useEffect)(()=>{m&&y(m,!0)},[m]),v.default.createElement("div",{className:"input-container"},v.default.createElement("label",{"aria-label":e,className:p?"input":"label"},v.default.createElement("input",{"aria-label":e,type:a,accept:p?null!=(o=null==l?void 0:l.accept)?o:"image/*":void 0,multiple:p?null!=(s=null==l?void 0:l.multiple)&&s:void 0,className:"input encore-text",value:null!=d?d:"",onChange:t,placeholder:n,step:f?null!=(c=null==l?void 0:l.step)?c:1:void 0,min:!f||null==l?void 0:l.min,max:!f||null==l?void 0:l.max,ref:i,style:p?{display:"none"}:{}}),p?"Upload Image":null))}),Ae=e(t()),$e=({onChange:e,checked:t,label:a})=>Ae.default.createElement("div",{className:"slider-wrapper"},Ae.default.createElement("label",{className:"switch","aria-label":a},Ae.default.createElement("input",{"aria-label":"toggleSwtich",type:"checkbox",checked:t,onChange:()=>{e(!t)}}),Ae.default.createElement("span",{className:"slider round"}))),s=e(t()),De=({title:e,tooltip:t,selectedValue:a,type:n,settings:r,children:l,style:i})=>s.default.createElement("div",{className:"card"},s.default.createElement(Be,{title:e,tooltip:t,selectedValue:a}),s.default.createElement("div",{className:"children-wrapper",style:i||{}},"dropdown"===n&&s.default.createElement(je,d({},r)),"input"===n&&s.default.createElement(Oe,d({},r)),"toggle"===n&&s.default.createElement($e,d({},r)),"button"===n&&s.default.createElement(o,d({},r)),l)),Te=e(t()),ze=e=>{var{children:t,className:a}=e,e=W(e,["children","className"]);return Te.default.createElement("div",u(d({},e),{className:"cards-wrapper "+(a||"")}),t)},i=e(t()),Fe=n=>{let[e,r]=(0,i.useState)(new Map);return i.default.useEffect(()=>{var e,t,a=new Map;for(t of n)a.has(t.id)||a.set(t.id,[]),null!=(e=a.get(t.id))&&e.push(t);r(a)},[n]),Array.from(e.entries()).map(([e,t])=>{var a,t=t.filter(e=>e.conditionalRender);return 0<t.length?i.default.createElement(ze,{key:e,id:e,className:e+" combine"},null!=(a=t[0])&&a.sectionName?i.default.createElement("label",{"aria-label":null==(a=t[0])?void 0:a.sectionName,htmlFor:e},null==(a=t[0])?void 0:a.sectionName):null,t.map(e=>i.default.createElement(De,d({key:e.id},e.cardProps)))):null})},h=e(t()),Ve=()=>{let{backgroundSettings:{mode:e,styles:t,customBackgroundOverride:a},colorSettings:{isDynamicColor:n},setBackgroundMode:r,updateBackgroundStyle:l,setIsDynamicColor:i,setCustomBackgroundOverride:o}=O(),{isUseLocalImage:s,setUseLocalImage:c,clearSelectedLocalImage:d,selectedLocalImage:u,setSelectedLocalImage:m}=he(),[g,p]=(0,h.useState)(e);var f=[{id:"backgroundOption",conditionalRender:!0,cardProps:{title:"Background Option",type:"dropdown",tooltip:"Select the background mode to customize your background.",settings:{placeholder:g,selectedValue:g,options:Y,onChange:e=>{p(e),r(e)}}}},...ke(t,e,l),{id:"backgroundCustomImage",sectionName:"Custom Background",conditionalRender:"static"===e,cardProps:{title:"Background image",type:"input",tooltip:h.default.createElement(h.default.Fragment,null,h.default.createElement("span",null,"Use a custom URL for the background image."),h.default.createElement("span",null,"Ensure the URL is a valid image link (e.g., .jpg, .png)."),h.default.createElement("span",null,'Use "now-playing" for the now playing art image.'),h.default.createElement("span",null,'Use "current-page" for the current page art image.')),settings:{type:"text",defaultValue:(null==a?void 0:a.url)||"",label:"Url",validation:e=>we(e),onChange:e=>{o(e)}}}},{id:"backgroundCustomImage",conditionalRender:"static"===e,cardProps:{title:"Use Local Image",type:"toggle",tooltip:h.default.createElement(h.default.Fragment,null,h.default.createElement("p",null,"Import an image from your device to use as the background."),null!=u&&u.dataURL?h.default.createElement("div",null,h.default.createElement("img",{width:"20rem",src:u.dataURL,alt:`${null==u?void 0:u.fileName} image`,style:{display:"block",width:"20rem",borderRadius:"0.5rem",border:"var(--border-thickness) var(--border-style, solid) var(--border-color, rgba(var(--spice-rgb-text), 0.125))"}}),null!=u&&u.fileName?h.default.createElement("p",null,"File name: ",h.default.createElement("span",null,u.fileName)):null,null!=u&&u.dateAdded?h.default.createElement("p",null,"Date Added: ",h.default.createElement("span",null,u.dateAdded)):null):null),settings:{checked:s,label:"Enable Local Image",onChange:e=>{c(e),!1===e&&d()}}}},{id:"backgroundCustomImageInput",conditionalRender:"static"===e&&s,cardProps:{title:"Select Background Image",type:"input",tooltip:"Choose an image file from your device.",settings:{type:"file",label:"Choose File",onChange:e=>{let t=null==e?void 0:e[0];t&&((e=new FileReader).readAsDataURL(t),e.onload=e=>{e=(null==(e=e.target)?void 0:e.result)||"";b("Local Image Data URL:",e),y(h.default.createElement("div",{style:{display:"flex",alignItems:"center"}},h.default.createElement("span",{style:{marginRight:"10px"}},"Successfully Added Local Image as background from File name:"),h.default.createElement("span",{style:{fontWeight:"bold"}},t.name))),m({dataURL:e,fileName:t.name||"",dateAdded:(new Date).toLocaleString()})})}}}},{id:"dynamicColorToggle",conditionalRender:!0,cardProps:{title:"Dynamic Color",type:"toggle",tooltip:"Enable dynamic color to adjust colors based on current playing album art.",settings:{checked:n,label:"Dynamic Color Toggle",onChange:e=>{i(e),e&&y("Enabled Dynamic Color.")}}}}];return h.default.createElement(j,{title:"Background Settings",description:"Set your Spotify interface settings."},Fe(f))},g=e(t()),He=()=>{let{exportSettings:t,importSettings:a}=O(),[e,n]=(0,g.useState)(!1),r=(0,g.useRef)(null);let l=()=>{var e=(null==(e=r.current)?void 0:e.value.trim())||"{}";"{}"===e?y("Please enter valid JSON settings.",!0):a(e)};return g.default.createElement(j,{title:"Settings Import/Export",description:"Manage your settings easily."},g.default.createElement(ze,null,g.default.createElement(De,{title:"Import and Export Settings",type:"normal",tooltip:"Use these buttons to import settings from a JSON file or export your current theme settings to your clipboard.",style:{display:"flex",gap:"0.5rem"}},g.default.createElement(o,{onClick:()=>{var e=t();navigator.clipboard.writeText(e).then(()=>{y("Settings exported to clipboard!")}).catch(e=>{w("Failed to copy: ",e),y("Failed to copy settings to clipboard.",!0)})}},"Export"),g.default.createElement(o,{onClick:()=>{n(e=>!e),e&&r.current&&(r.current.value="")},variant:e?"danger":"primary"},e?"Cancel Import":"Import")),e&&g.default.createElement(De,{title:"Import Settings JSON",type:"normal",tooltip:"Paste your JSON settings here to import them. Ensure the JSON is correctly formatted.",style:{display:"flex",gap:"0.5rem"}},g.default.createElement(o,{onClick:async()=>{try{var e=await navigator.clipboard.readText();r.current&&(r.current.value=e,l()),y("Clipboard content pasted successfully!")}catch(e){w("Failed to read clipboard: ",e),y("Failed to read clipboard content.",!0)}}},"Paste And Import"),g.default.createElement(Oe,{ref:r,type:"text",label:"Paste JSON here",placeholder:"Paste JSON here"}),g.default.createElement(o,{onClick:l},"Import"))))},qe="1.2.46"<=Spicetify.Platform.version,Ze="light"===(null==Spicetify?void 0:Spicetify.Config.color_scheme)||!1,We=!(!Spicetify.Platform||"Windows"!==Spicetify.Platform.operatingSystem)||!(null==(E=null==(E=Spicetify.Platform)?void 0:E.PlatformData)||!E.os_name)&&Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"),Je=!(!document.querySelector(".globalNav")&&!document.querySelector(".Root__globalNav")),Ge=!!document.getElementById("customControls")&&(null!=(E=document.querySelector(".lucid-transperent-window-controls"))&&E.remove(),!0),A=e(t()),Xe=()=>{let{interfaceSettings:{controlSettings:{height:e},fontSettings:{body:{fontFamily:t}},grainSettings:{grainEffect:a},pagesSettings:{isScrollMode:n,backgroundImageMode:r,playlistViewMode:l},borderSettings:{color:i,style:o,thickness:s,roundedRadius:c}},npvSettings:{mode:d,position:u,blur:m},setFont:g,setGrainEffect:p,setControlHeight:f,setPagesBackgroundImageMode:b,setPlaylistViewMode:y,setIsScrollMode:v,setNpvMode:h,setNpvBlur:S,setCompactNpvPosition:w,setBorderColor:E,setBorderStyle:k,setBorderThickness:x,settingAccessPosition:R,setRoundedBorderRadius:P,setSettingAccessPosition:C}=O(),[L,N]=(0,A.useState)(a),[I,M]=(0,A.useState)(r),[B,U]=(0,A.useState)(l);var _=[{id:"controlSettings",conditionalRender:We,cardProps:{title:"Set Control Height",tooltip:"Set the height of your window controls in pixels.",type:"input",settings:{type:"number",label:"Enter Control Height",defaultValue:e,onChange:e=>{f(Number(e))},settings:{step:1,min:1,max:64}}}},{id:"themeSettings",conditionalRender:!0,cardProps:{title:"Settings Access Position",tooltip:"Choose how to access settings: via the context menu button or a navigation button.",type:"dropdown",settings:{options:re,placeholder:R,selectedValue:R,onChange:e=>{C(e)}}}},{id:"npvSettings",conditionalRender:!0,cardProps:{title:"Set Right Sidebar Mode",tooltip:A.default.createElement(A.default.Fragment,null,A.default.createElement("h3",{className:"encore-text encore-text-medium-bold"},"Select how the right sidebar appears during playback."),A.default.createElement("span",null,"Choose 'Compact' for a minimized view or 'Normal' for a detailed layout")),type:"dropdown",settings:{options:le,placeholder:d,selectedValue:d,onChange:e=>{h(e)}}}},{id:"npvSettings",conditionalRender:"compact"===d,cardProps:{title:"Set Compact Sidebar Position",tooltip:A.default.createElement(A.default.Fragment,null,A.default.createElement("h3",{className:"encore-text encore-text-medium-bold"},"Select where the right sidebar appears.")),type:"dropdown",settings:{options:ie,placeholder:u,selectedValue:u,onChange:e=>{w(e)}}}},{id:"npvSettings",sectionName:"Styles",conditionalRender:"compact"===d,cardProps:{title:"Set Npv Background Blur",type:"input",settings:{label:"Npv Background Blur input",defaultValue:m,onChange:e=>{S(Number(e))},type:"number",settings:{max:256,min:0,step:.5}}}},{id:"font",conditionalRender:!0,cardProps:{title:"Font",type:"input",tooltip:A.default.createElement(A.default.Fragment,null,"Supports both Google Fonts via URL and local fonts.",A.default.createElement("span",null,"For Google Fonts, use the full URL (e.g., https://fonts.googleapis.com/css2?family=Roboto)."," "),A.default.createElement("span",null,"For local fonts, type the font family name (e.g., 'Arial').")),settings:{type:"text",label:"Font Family or URL",defaultValue:t,onChange:e=>{g("body",(e=>{let t="",a="";return t=we(e)?(a=e,Ee(e)):a=e,{url:a,fontFamily:t}})(e.toString()))}}}},{id:"grains",conditionalRender:!0,cardProps:{type:"dropdown",title:"Grains",tooltip:"Choose a grain texture mode.",settings:{options:ee,placeholder:L,selectedValue:L,onChange:e=>{N(e),p(e)}}}},{id:"pageSettings",sectionName:"Pages Setting",conditionalRender:!0,cardProps:{type:"dropdown",title:"Pages Background Image",tooltip:"Choose a background image mode for playlist pages.",settings:{options:te,placeholder:I,selectedValue:I,onChange:e=>{M(e),b(e)}}}},{id:"pageSettings",conditionalRender:!0,cardProps:{type:"dropdown",tooltip:"Sets the view mode for playlists.",title:"Playlist View",settings:{options:ae,placeholder:B,selectedValue:B,onChange:e=>{U(e),y(e)}}}},{id:"pageSettings",conditionalRender:!0,cardProps:{title:"Toggle Playlist Scroll Mode",tooltip:"Enable or disable scrolling for the playlist art image.",type:"toggle",settings:{checked:n,label:"Scroll Mode Toggle",onChange:e=>{v(e)}}}},{id:"borderSettings",conditionalRender:!0,sectionName:"Border Settings",cardProps:{title:"Border Thickness",type:"input",settings:{type:"number",label:"Border Thickness",defaultValue:s,onChange:e=>{x(Number(e))},settings:{step:1,min:0,max:8}}}},{id:"borderSettings",conditionalRender:!0,sectionName:"Border Settings",cardProps:{title:"Rounded Border Radius",type:"input",settings:{type:"number",label:"Rounded Border Radius",defaultValue:c,onChange:e=>{P(Number(e))},settings:{step:1,min:0,max:999}}}},{id:"borderSettings",conditionalRender:!0,cardProps:{title:"Border Color",type:"input",settings:{type:"text",label:"Border Color",defaultValue:i,onChange:e=>{E(e)}}}},{id:"borderSettings",conditionalRender:!0,cardProps:{title:"Border Style",type:"dropdown",settings:{options:ne,selectedValue:o,onChange:e=>{k(e)}}}}];return A.default.createElement(j,{title:"Interface Settings",description:"Set your Spotify interface settings."},Fe(_))},Qe=e(t()),Ye=()=>{let{playbarSettings:{mode:e,styles:t},setPlaybarMode:a,updatePlaybarStyle:n}=O(),[r,l]=(0,Qe.useState)(e);var i=[{id:"playbarOption",conditionalRender:!0,cardProps:{title:"Playbar Option",type:"dropdown",settings:{placeholder:r,selectedValue:r,options:K,onChange:e=>{l(e),a(e)}}}},...ke(t,e,n)];return Qe.default.createElement(j,{title:"Playbar Settings",description:"Set your Spotify Now Playing Bar settings."},Fe(i))},Ke=e(t()),et=()=>{let e=O().resetAllSettings;return Ke.default.createElement(j,{title:"Reset Settings",description:"Reset your theme settings."},Fe([{id:"resetButtonCard",conditionalRender:!0,cardProps:{title:"Reset All Settings",type:"button",settings:{variant:"danger",size:"medium",children:"Reset",onClick:()=>{window.confirm("Are you sure you want to reset all settings to their default values? This action cannot be undone.")&&e()}}}}]))},p=e(t()),tt={settings:!1,changelog:!1},{ModalContextProvider:at,useModal:nt}=(()=>{let l=(0,p.createContext)(null);return{ModalContextProvider:({children:e})=>{let[a,n]=(0,p.useState)(tt),t=(0,p.useCallback)(t=>({isOpen:a[t],openModal:(0,p.useCallback)(()=>{n(e=>u(d({},e),{[t]:!0}))},[t]),closeModal:(0,p.useCallback)(()=>{n(e=>u(d({},e),{[t]:!1}))},[t])}),[a]);var r=(0,p.useMemo)(()=>t,[t]);return p.default.createElement(l.Provider,{value:r},e)},useModal:e=>{var t=(0,p.useContext)(l);if(t)return t(e);throw new Error("Wrap Element with ModalContextProvider")}}})(),f=e(t()),rt=(0,f.memo)(()=>{var{isOpen:e,closeModal:t}=nt("settings");return f.default.createElement(X,{title:"Lucid Settings",onClose:t,isOpen:e},f.default.createElement("div",{className:"sections-container"},f.default.createElement(Ve,null),f.default.createElement(Xe,null),f.default.createElement(Ye,null),f.default.createElement(et,null),f.default.createElement(He,null)))}),lt=e(t()),it=()=>{b("hook running useSettingsAccess");let t=O().settingAccessPosition,a=nt("settings").openModal,n=(0,lt.useRef)(null);(0,lt.useEffect)(()=>{var e;return"context-menu"===t&&(n.current=new Spicetify.Menu.Item("Lucid Settings",!1,a,'<svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="#fff"/></svg>'),n.current.register()),"nav"!==t||document.querySelector(".main-actionButtons button[aria-label='Lucid Settings']")||n.current instanceof HTMLButtonElement||(e=new Spicetify.Topbar.Button("Lucid Settings",'<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>',a,!1,!0),n.current=e),()=>{var e;n.current instanceof Spicetify.Menu.Item&&n.current.deregister(),n.current instanceof Spicetify.Topbar.Button&&n.current.element.remove(),null!=(e=document.querySelector(".Root__globalNav .main-actionButtons div:has(button[aria-label='Lucid Settings'])"))&&e.remove()}},[t,a])},ot=e(t()),st=(0,ot.memo)(()=>{b("Render <SettingsManager />");var e=nt("settings").isOpen;return it(),ot.default.createElement(ot.default.Fragment,null,e&&ot.default.createElement(rt,null))}),ct=(e,t)=>[e,t].filter(Boolean).join(" ").trim(),dt=e=>{var t;return Object.keys(e).length?(t={},void 0!==e.blur&&(t.filter=ct(t.filter,`blur(${e.blur}px)`)),void 0!==e.backdropBlur&&(t.backdropFilter=`blur(${e.backdropBlur}px)`),void 0!==e.contrast&&(t.filter=ct(t.filter,`contrast(${e.contrast})`)),void 0!==e.brightness&&(t.filter=ct(t.filter,`brightness(${e.brightness})`)),void 0!==e.saturation&&(t.filter=ct(t.filter,`saturate(${e.saturation})`)),void 0!==e.width&&(t.width=e.width+"px"),void 0!==e.height&&(t.height=e.height+"px"),void 0===e.paddingX&&void 0===e.paddingY||(t.padding=`${e.paddingY||0}px ${e.paddingX||0}px`),void 0!==e.borderRadius&&(t.borderRadius=e.borderRadius+"px"),void 0!==e.backgroundColor&&(t.backgroundColor=""+e.backgroundColor),t):{}},ut=(e,t=!1)=>{var a;return Object.keys(e).length?(a={},void 0!==e.blur&&(a["--blur"]=e.blur+"px"),void 0!==e.backdropBlur&&(a["--backdrop-blur"]=e.backdropBlur+"px"),void 0!==e.contrast&&(a["--contrast"]=e.contrast),void 0!==e.brightness&&(a["--brightness"]=e.brightness),void 0!==e.saturation&&(a["--saturation"]=e.saturation),void 0!==e.width&&(a["--width"]=e.width+"px"),void 0!==e.height&&(a["--height"]=e.height+"px"),void 0!==e.paddingX&&(a["--padding-x"]=e.paddingX+"px"),void 0!==e.borderRadius&&(a["--border-radius"]=e.borderRadius+"px"),void 0!==e.backgroundColor&&(a["--background-color"]=e.backgroundColor),void 0!==e.time&&(a["--time"]=e.time+"s"),t?Object.entries(a).map(([e,t])=>e+`: ${t};`).join(" "):a):t?"":{}},S=e(t()),E=({style:e})=>S.default.createElement("div",{className:"animated-background-container",style:d({},ut(e))},S.default.createElement("div",{className:"back"}),S.default.createElement("div",{className:"backleft"}),S.default.createElement("div",{className:"backright"}),S.default.createElement("div",{className:"front"})),mt=e(t()),gt=({style:e})=>mt.default.createElement("div",{className:"solid-background",style:d({},dt(e))}),pt={underMainBackgroundImage:"",pageCategory:"other",artworkData:{nowPlayingArtURL:"",currentPageURI:"",currentPageArtURL:""},windowZoom:1},k=bt(e=>u(d({},pt),{updateArtworkData:t=>e(e=>u(d({},e),{artworkData:d(d({},e.artworkData),t)})),setPageCategory:t=>e(e=>u(d({},e),{pageCategory:t})),setUnderMainViewBackgroundImage:t=>e(e=>u(d({},e),{underMainBackgroundImage:t})),setIsCustomControls:t=>e(e=>u(d({},e),{isCustomControls:t})),setWindowZoom:t=>e(e=>u(d({},e),{windowZoom:t}))})),ft=e(t()),bt=({style:e})=>{let t=O().backgroundSettings.customBackgroundOverride,a=k().artworkData,{isUseLocalImage:n,selectedLocalImage:r}=he();var l=n&&null!=r&&r.dataURL?r.dataURL:"current-page"===(l=t.url)?(null==a?void 0:a.currentPageArtURL)||(null==a?void 0:a.nowPlayingArtURL)||"":l&&""!==l.trim()&&"now-playing"!==l?l||"":(null==a?void 0:a.nowPlayingArtURL)||"";return ft.default.createElement("div",{className:"static-background",style:d({backgroundImage:`url(${l})`},dt(e))})},yt=e(t()),vt={animated:E,static:bt,solid:gt},ht=()=>{b("Render <BackgroundManager />");var{mode:e,styles:t}=O().backgroundSettings,t=t[e],e=vt[e];return yt.default.createElement("div",{className:"background-wrapper"},e?yt.default.createElement(e,{style:t}):yt.default.createElement(gt,{style:{backgroundColor:"#202020"}}))},St=()=>{var e=document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image");return(null==e?void 0:e.src)||""},wt=async e=>{let t=0;for(;t<=3;)try{var a=await Spicetify.GraphQL.Request({name:"queryArtistOverview",operation:"query",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497",value:null},{uri:e,includePrerelease:!0,locale:null});if(a)return a}catch(e){if(!(e instanceof Error&&e.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3))throw w("Error fetching artist metadata:",e),e;t++,Ie(`Duplicate request detected (getArtistMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(e=>setTimeout(e,1e3))}},Et=async e=>{let t=0;for(;t<=3;)try{var a=await Spicetify.GraphQL.Request({name:"getAlbum",operation:"query",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d",value:null},{uri:e,locale:null,offset:0,limit:50});if(a)return a}catch(e){if(!(e instanceof Error&&e.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3))throw w("Error fetching album metadata:",e),e;t++,Ie(`Duplicate request detected (getAlbumMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(e=>setTimeout(e,1e3))}},kt=e(t()),xt=()=>{b("Render <ArtworkManager />");let{pageCategory:e,artworkData:o,updateArtworkData:s}=k(),{pagesSettings:t}=O().interfaceSettings,a=(0,kt.useCallback)(async()=>{var e,t,a,n,r,l=Spicetify.Platform.History.location.pathname,i=(l=l,i=Spicetify.URI.isPlaylistV1OrV2(l),e=Spicetify.URI.isArtist(l),t=Spicetify.URI.isAlbum(l),a=Spicetify.URI.isShow(l),n=Spicetify.URI.isProfile(l),i||e||t||n||a?(n=null==(n=l.match(/\/(?:playlist|artist|album|user|show)\/([^/]+)/))?void 0:n[1])?`spotify:${i?"playlist":e?"artist":t?"album":a?"show":"user"}:`+n:(Ie("No ID found in pathname:",l),null):null);if(o.currentPageURI!==i){document.documentElement.style.setProperty("--artwork-opacity","0");try{i?(r=await(async e=>{var t,a,n,r,l,i,o,s,c,d,u,m,g,p,f,b,y=e.split(":")[1];try{switch(y){case"playlist":case"show":return(null==(t=(await Spicetify.Platform.PlaylistAPI.getMetadata(e)).images.find(e=>e.url))?void 0:t.url)||null;case"artist":var v=await wt(e);return(null==(l=null==(r=null==(n=null==(a=v.data)?void 0:a.artistUnion.visuals.headerImage)?void 0:n.sources)?void 0:r[0])?void 0:l.url)||(null==(c=null==(s=null==(o=null==(i=v.data)?void 0:i.artistUnion.visuals.avatarImage)?void 0:o.sources)?void 0:s[0])?void 0:c.url)||null;case"album":var h=await Et(e);return(null==(m=null==(u=null==(d=h.data)?void 0:d.albumUnion.coverArt.sources)?void 0:u[2])?void 0:m.url)||(null==(f=null==(p=null==(g=h.data)?void 0:g.albumUnion.coverArt.sources)?void 0:p[0])?void 0:f.url)||null;case"user":var S=await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath("/profile/"+e.split(":")[2]).send();return(null==(b=null==S?void 0:S.body)?void 0:b.image_url)||null;default:return null}}catch(e){return w(`Error fetching artwork for ${y}:`,e),null}})(i)||"",s({currentPageArtURL:r,currentPageURI:i})):s({currentPageArtURL:"",currentPageURI:""})}catch(e){w("Error updating artwork:",e),s({currentPageArtURL:"",currentPageURI:""})}finally{setTimeout(()=>document.documentElement.style.setProperty("--artwork-opacity","1"),500)}}},[o.currentPageURI,s]);return(0,kt.useEffect)(()=>{if(o.currentPageArtURL?(document.documentElement.style.setProperty("--playlist-art-image",`url(${o.currentPageArtURL})`),c("Updated Playlist Artwork URL to "+o.currentPageArtURL)):o.currentPageURI&&"other"!==e&&(w("No artwork URL found for URI: "+o.currentPageURI),document.documentElement.style.setProperty("--playlist-art-image","none")),"inherit"===t.backgroundImageMode){let e=Spicetify.Platform.History.listen(a);return a(),()=>{e()}}},[t.backgroundImageMode,o.currentPageArtURL,o.currentPageURI,e,a]),(0,kt.useEffect)(()=>{o.nowPlayingArtURL&&(document.documentElement.style.setProperty("--now-playing-art-image",`url("${o.nowPlayingArtURL}")`),c("Updated Now Playing Art View: "+o.nowPlayingArtURL))},[o.nowPlayingArtURL]),(0,kt.useEffect)(()=>{let e=async()=>{await(async()=>{for(var e;null==(e=null==Spicetify?void 0:Spicetify.Player)||!e.data;)await new Promise(e=>setTimeout(e,100))})();var e=await((e=Spicetify.Player.data.item)&&e.metadata?[e.metadata.image_xlarge_url,e.metadata.image_large_url,e.metadata.image_url,e.metadata.image_small_url].find(e=>e)||St()||"":(w("No item or metadata found in Spicetify Player data."),""));s({nowPlayingArtURL:e})};return e(),Spicetify.Player.addEventListener("songchange",e),()=>{Spicetify.Player.removeEventListener("songchange",e)}},[s]),null},Rt=e(t()),Pt=()=>{let{borderSettings:t}=O().interfaceSettings;return(0,Rt.useEffect)(()=>{e=t;var e=Object.keys(e).length?Object.entries(e).map(([e,t])=>`--border-${e}: ${"thickness"===e||"roundedRadius"===e?t+"px":t};`).join(" "):"";document.documentElement.style.cssText+=e},[t]),null},Ct=(e,t,a)=>"#"+(e<<16|t<<8|a).toString(16).padStart(6,"0"),Lt=(e,t,a)=>{var[e,t,a]=[e/255,t/255,a/255],[e,t,a]=[e<=.03928?e/12.92:((e+.055)/1.055)**2.4,t<=.03928?t/12.92:((t+.055)/1.055)**2.4,a<=.03928?a/12.92:((a+.055)/1.055)**2.4];return.2126*e+.7152*t+.0722*a},Nt=(e,t)=>u(d({},e),{r:Math.max(0,Math.round(e.r*t)),g:Math.max(0,Math.round(e.g*t)),b:Math.max(0,Math.round(e.b*t)),hex:Ct(Math.max(0,Math.round(e.r*t)),Math.max(0,Math.round(e.g*t)),Math.max(0,Math.round(e.b*t)))}),x=(e,t)=>u(d({},e),{r:Math.min(255,Math.round(e.r+(255-e.r)*t)),g:Math.min(255,Math.round(e.g+(255-e.g)*t)),b:Math.min(255,Math.round(e.b+(255-e.b)*t)),hex:Ct(Math.min(255,Math.round(e.r+(255-e.r)*t)),Math.min(255,Math.round(e.g+(255-e.g)*t)),Math.min(255,Math.round(e.b+(255-e.b)*t)))}),It=(e,t)=>{e=Lt(e.r,e.g,e.b),t=Lt(t.r,t.g,t.b);return(Math.max(e,t)+.05)/(Math.min(e,t)+.05)},Mt=e(G()),Bt=null;async function Ut(s,e,c){return e&&c?new Promise(o=>{Bt&&clearTimeout(Bt),Bt=setTimeout(async()=>{try{var e,t,a,n=await(async r=>{try{var l=await(0,Mt.loadImage)(r),i=Math.max(l.width/10,10),o=Math.max(l.height/10,10),s=(0,Mt.createCanvas)(i,o).getContext("2d"),c=(s.drawImage(l,0,0,i,o),s.getImageData(0,0,i,o)),d=c.data,u={};let t={};var m=Math.floor(.2*d.length);for(let e=0;e<m;e+=4){var g=d[e],p=d[e+1],f=d[e+2],b=g+`-${p}-`+f;u[b]=(u[b]||0)+1,t[b]={r:g,g:p,b:f,hex:Ct(g,p,f)}}var y=Object.entries(u).sort((e,t)=>t[1]-e[1]).map(([e])=>t[e]),v=y[0];let e=y[1],a=y[2],n=2;for(;!e||It(v,e)<2.5;){if(n>=y.length){e=x(v,.2);break}e=y[n],n++}for(;!a||It(v,a)<2.5||It(e,a)<2.5;){if(n>=y.length){a=x(e,.2);break}a=y[n],n++}return{baseColor:v,secondaryColor:e,tertiaryColor:a}}catch(e){return w("Error extracting colors: ",e),e}})(c);n instanceof Error?(w("Error extracting colors: "+n.message),o(null)):(e=({baseColor:r,secondaryColor:l,tertiaryColor:i}=[n][0],{main:Nt(l,.4),sidebar:Nt(l,.5),card:Nt(i,.5),player:Nt(l,.6),"progress-bar":x(l,.6),accent:x(r,.4),highlight:x(l,.2),button:x(i,.4),"button-active":x(i,.4),text:x(r,.9),subtext:x(l,.9),primary:r,secondary:l,tertiary:i}),t=s,a=e,a=`:root {${Object.entries(a).map(([e,t])=>`
--spice-${e}: ${t.hex} !important;
--spice-rgb-${e}: ${t.r}, ${t.g}, ${t.b} !important;`).join("")}
}`,a+=":root{\nwill-change: --spice-main,--spice-rgb-main,--spice-sidebar,--spice-rgb-sidebar,--spice-card,--spice-rgb-card,--spice-player,--spice-rgb-player,--spice-accent,--spice-rgb-accent,--spice-highlight,--spice-rgb-highlight,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-text,--spice-rgb-text,--spice-progress-bar,--spice-rgb-progress-bar,--spice-subtext,--spice-rgb-subtext,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;\ntransition: all 0.3s ease-in-out;\n}",t.textContent=a,o(n))}catch(e){w("Error saving colors to style: ",e instanceof Error?e.message:e),o(null)}var r,l,i},200)}):null}var _t=e(t()),jt=()=>{b("Render <ColorManager />");let{isDynamicColor:e}=O().colorSettings,t=k().artworkData,a=(0,_t.useRef)(null),n=(0,_t.useRef)(null);return(0,_t.useEffect)(()=>(a.current=document.createElement("style"),a.current.id="lucid_dynamic_colors",document.head.appendChild(a.current),()=>{a.current&&document.head.removeChild(a.current)}),[]),(0,_t.useEffect)(()=>{e?e&&t.nowPlayingArtURL!==n.current&&(null!=a&&a.current&&e&&t.nowPlayingArtURL&&Ut(a.current,e,t.nowPlayingArtURL).then(()=>{c("Dynamic colors updated!")}).catch(e=>{w("Error updating colors:",e)}),n.current=t.nowPlayingArtURL):(n.current&&(n.current=null),a.current&&(async e=>{e.textContent=":root{\nwill-change: --spice-main,--spice-rgb-main,--spice-sidebar,--spice-rgb-sidebar,--spice-card,--spice-rgb-card,--spice-player,--spice-rgb-player,--spice-accent,--spice-rgb-accent,--spice-highlight,--spice-rgb-highlight,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-text,--spice-rgb-text,--spice-progress-bar,--spice-rgb-progress-bar,--spice-subtext,--spice-rgb-subtext,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;\ntransition: all 0.3s ease-in-out;\n}"})(a.current))},[e,t.nowPlayingArtURL]),null},Ot=e(t()),At=()=>{let{fontSettings:e}=O().interfaceSettings,r=(0,Ot.useCallback)((e,t)=>{document.documentElement.style.setProperty(`--${e}-font-to-use`,t)},[]),t=(0,Ot.useCallback)(async t=>{var{fontFamily:a,url:n}=e[t];try{await((e,t)=>{let a=document.getElementById(t);a||((a=document.createElement("link")).rel="stylesheet",a.id=t,document.head.appendChild(a)),a.href=e})(n,t+"-font"),r(t,a)}catch(e){w("Failed to load font from "+n,e),r(t,a)}},[e,r]);return(0,Ot.useEffect)(()=>{Object.keys(e).map(e=>t(e))},[e,t]),null},$t=e(t()),R=e=>{(0,$t.useEffect)(()=>{if(e)return document.body.classList.add(e),()=>{document.body.classList.remove(e)}},[e])},Dt=()=>(b("Render <GlobalNavManager />"),R(Je?"global-nav":"control-nav"),null),Tt=e(t()),zt=()=>{b("Render <GrainManager />");var{grainSettings:{grainEffect:e}}=O().interfaceSettings;return R("grain-"+e),Tt.default.createElement("div",{id:"grainEffect","data-grainEffect":e})},Ft=e(t()),Vt=()=>{let{pageCategory:e,setPageCategory:a}=k();return R(e),(0,Ft.useEffect)(()=>{let e=()=>{var e=Spicetify.Platform.History.location.pathname;a((e=e,Spicetify.URI.isPlaylistV1OrV2(e)?"playlist":Spicetify.URI.isArtist(e)?"artist":Spicetify.URI.isAlbum(e)?"album":Spicetify.URI.isGenre(e)?"genre":Spicetify.URI.isShow(e)?"show":Spicetify.URI.isSearch(e)?"search":Spicetify.URI.isProfile(e)?"profile":Spicetify.URI.isConcert(e)||Spicetify.URI.isArtistConcerts(e)?"concert":"other"))},t=(e(),Spicetify.Platform.History.listen(()=>{e()}));return()=>{t()}},[a]),null},Ht=e(t()),qt=".Root__now-playing-bar",Zt=()=>{let r=O().playbarSettings,l=(0,Ht.useRef)(document.querySelector(qt));return R("playbar-"+r.mode),(0,Ht.useEffect)(()=>{var e,t,a,n;l.current?({mode:t,styles:n}=r,a=ut(n[t],!0),n="compact"===t?n[t].height:(null==(e=l.current)?void 0:e.clientHeight)||(null==(e=n[t])?void 0:e.height),document.documentElement.style.setProperty("--playbar-height",n+"px"),l.current.style.cssText=a.toString()):w(`Playbar element with class '${qt}' not found!`)},[r]),null},Wt=e(t()),Jt=()=>{let{underMainBackgroundImage:a,setUnderMainViewBackgroundImage:n}=k(),r=(0,Wt.useCallback)(e=>{e=e.reduce((e,t)=>{if(e)return e;if("childList"===t.type&&0<t.addedNodes.length){e=t.addedNodes[0];if(e.firstChild instanceof HTMLDivElement)return e.firstChild}return null},null);let t=null;null!=e&&e.style?t=e.style.backgroundImage.replace(/url\(['"]?([^'"]*)['"]?\)/i,"$1"):null!==a&&(t=null),n(t)},[n,a]);(0,Wt.useEffect)(()=>{let e=new MutationObserver(r);var t=document.querySelector(".under-main-view");return t&&e.observe(t,{childList:!0}),()=>e.disconnect()},[r]),(0,Wt.useEffect)(()=>(document.documentElement.style.setProperty("--under-main-view-art-image",a?`url(${a})`:null),()=>{document.documentElement.style.removeProperty("--under-main-view-art-image")}),[a])},P=e(t()),Gt=()=>{let{pagesSettings:{playlistViewMode:e,isScrollMode:a,backgroundImageMode:t}}=O().interfaceSettings,{pageCategory:n,underMainBackgroundImage:r,artworkData:l}=k(),i=(0,P.useRef)(null),o=(0,P.useRef)(null),s=(R("playlist-view-"+e),R("playlist-art-image-"+t),R(r?"under-main-view-present":""),(0,P.useCallback)(e=>{var t=i.current;t&&(e=Math.min(e.scrollTop,window.innerHeight),t.style.transform=`translate3d(0, ${a?-e:0}px, 0)`,t.style.setProperty("--scroll",""+e/1e3))},[a])),c=(0,P.useMemo)(()=>"artist"===n||r?0:4,[n,r]);(0,P.useEffect)(()=>{var e=o.current;e&&e.style.setProperty("--blur",c+"px")},[c]),(0,P.useEffect)(()=>{let t=document.querySelector(".Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport]");if(t){let e=()=>s(t);return e(),t.addEventListener("scroll",e,{passive:!0}),()=>{t.removeEventListener("scroll",e)}}},[s]),b("New underMainBackgroundImage:",r);var d="other"!==n&&"none"!==t?r||("inherit"===t?l.currentPageArtURL||"":l.nowPlayingArtURL||""):"none";return P.default.createElement("span",{id:"playlistArtContainer",className:`playlist-art-container ${e} `+t,"data-playlist-view-mode":e,ref:i},P.default.createElement("div",{className:"background",ref:o,style:{backgroundImage:`url(${d})`}}),P.default.createElement("div",{className:"overlay",style:{height:"100%",width:"100%",position:"absolute",inset:0}}))},Xt=e(t()),Qt=()=>(b("Render <UnderMainViewManager />"),(()=>{let a=(0,Xt.useRef)(null);(0,Xt.useEffect)(()=>{let e=()=>{var e,t;document.getElementById("lucid-under-main-view")||((e=document.createElement("div")).id="lucid-under-main-view",e.className="lucid-under-main-view",(t=document.querySelector(".main-view-container"))&&t.prepend(e),a.current=e,a.current&&Spicetify.ReactDOM.createRoot(a.current).render(Xt.default.createElement(Gt,null)))},t=(e(),Spicetify.Platform.History.listen(()=>{e()}));return()=>{t()}},[])})(),Jt(),null),Yt=e(t()),Kt=()=>{var e=(0,Yt.useRef)(null);let[t,n]=(0,Yt.useState)({}),r=k().windowZoom,{controlSettings:{height:l}}=O().interfaceSettings;return(0,Yt.useEffect)(()=>{let e=()=>{var e,t;We&&((async t=>{var e;try{null!=(e=null==Spicetify?void 0:Spicetify.CosmosAsync)&&e.post&&await Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:t}),c(`Control height set to ${t}px`)}catch(e){w("Error setting control height: "+t)}})(l),Ge||Ze?n({}):(e=l||(qe?32:64),t=qe?(l/r-Math.min(32/r,l/r))/2:0,e=e/r-2*t,window.document.body.style.setProperty("--top-bar-padding-start",(l<=16?8:64)/r+"px"),window.document.body.style.setProperty("--top-bar-padding-end",(l<=16?8:135)/r+"px"),t={position:"fixed",right:0,top:t+"px",height:e+"px",width:135/r+"px",WebkitBackdropFilter:"brightness(2.12)",backdropFilter:"brightness(2.12)",pointerEvents:"none",zIndex:"var(--above-main-and-now-playing-view-grid-area, 6)"},n(t)))},t=(e(),()=>{e()}),a=setTimeout(e,1e3);return window.addEventListener("resize",t),()=>{clearTimeout(a),window.removeEventListener("resize",t)}},[r,l]),Yt.default.createElement("div",{ref:e,style:t})},C=e(t()),ea=(0,C.memo)(()=>C.default.createElement(C.default.Fragment,null,We?C.default.createElement("div",{id:"transperent-controls-container",style:{containerType:"normal",pointerEvents:"none"}},!Ge&&We?C.default.createElement(Kt,null):null):null)),L=e(t()),N=e(t()),ta=()=>{(0,N.useRef)({outerWidth:window.outerWidth,innerWidth:window.innerWidth,ratio:window.devicePixelRatio});let r=k().setWindowZoom,l=(0,N.useRef)(window.outerWidth),i=(0,N.useRef)(window.innerWidth),o=(0,N.useRef)(window.devicePixelRatio),s=(0,N.useRef)(!0),c=(0,N.useRef)(document.querySelector(".Root__main-view"));return(0,N.useEffect)(()=>{let e=()=>{document.documentElement.style.setProperty("--main-view-height",`${null==(t=c.current)?void 0:t.clientHeight}px`);var e,t=window.outerWidth,a=window.innerWidth,n=window.devicePixelRatio;(s.current||(l.current<=160||o.current!==n)&&(l.current!==t||i.current!==a))&&(e=t/a||1,r(e),document.documentElement.style.setProperty("--zoom",""+e),b(`Zoom Updated: ${t} / ${a} = `+e),l.current=t,i.current=a,o.current=n)},t=()=>{e()};return e(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[r]),null},aa=()=>{var{mode:e,position:t,blur:a}=O().npvSettings;return document.body.style.setProperty("--compact-npv-blur",a+"px"),R(e+"-npv"),R(t+"-npv"),null},na=()=>(b("Render <MainStateManager />"),L.default.createElement(L.default.Fragment,null,L.default.createElement(Vt,null),L.default.createElement(zt,null),L.default.createElement(jt,null),L.default.createElement(ta,null),L.default.createElement(Zt,null),L.default.createElement(xt,null),L.default.createElement(Pt,null),L.default.createElement(Dt,null),L.default.createElement(At,null),L.default.createElement(aa,null),L.default.createElement(Qt,null),L.default.createElement(ea,null)));function ra(e,t){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: ${t} !important; }
  `}function la(e){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: -1 !important; }
  `}function ia(t,a,n,r){let l=!1,i=null;new MutationObserver(()=>{var e=t.querySelector(a);e!==i&&(e&&!l?(c("Applying background z-index: "+r),l=!0,ra(n,r)):l&&(c("Removing background z-index: "+r),l=!1,document.querySelector("#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container")?ra(n,5):la(n)),i=e)}).observe(t,{childList:!0}),la(n)}var I=e(t()),M=e(t()),B=e(t()),oa=({releases:e,isLoading:t,error:a})=>t?B.default.createElement("div",null,"Loading release data..."):a?B.default.createElement("div",null,"Error fetching release data: ",a.message):e?B.default.createElement("div",{className:"lucid-changelog",id:"lucid-changelog"},e.map(e=>B.default.createElement("div",{key:e.tag_name,className:"release"},B.default.createElement("button",{className:"release-button",type:"button",onClick:()=>window.open(e.html_url,"_blank")},"View on GitHub"),e.body&&B.default.createElement("div",{className:"release-content",dangerouslySetInnerHTML:{__html:e.body}})))):B.default.createElement("div",null,"No release data found."),sa=e(t()),ca=({currentVersion:e})=>{let[t,r]=M.default.useState({isLoading:!0,error:null,releases:null}),[l,a]=((t,a)=>{let[e,n]=(0,sa.useState)(()=>{var e;return"undefined"!=typeof window&&(e=window.localStorage.getItem(t))?JSON.parse(e):a});return(0,sa.useEffect)(()=>{"undefined"!=typeof window&&window.localStorage.setItem(t,JSON.stringify(e))},[t,e]),[e,n]})("lucid:previousVersion",null),{closeModal:n,isOpen:i,openModal:o}=nt("changelog"),s=async()=>{b("Fetching release data..."),r(e=>u(d({},e),{isLoading:!0}));try{var e=await fetch("https://api.github.com/repos/sanoojes/spicetify-lucid/releases");if(!e.ok)throw new Error("HTTP error! status: "+e.status);var t=await e.json(),a=(b("Fetched release data:",t),await Promise.all(t.map(async e=>u(d({},e),{body:await(async(e,t,a)=>{try{var n={text:e,context:t+"/"+a,mode:"gfm"},r=await fetch("https://api.github.com/markdown",{method:"POST",body:JSON.stringify(n)});if(r.ok)return await r.text();throw new Error("HTTP error! status: "+r.status)}catch(e){return w("Error parsing markdown:",e),null}})(e.body,"sanoojes","spicetify-lucid")||""})))),n=(r({isLoading:!1,error:null,releases:a}),t[0].tag_name);null!==l&&n===l||(console.log("Opening changelog modal because new version detected"),o())}catch(t){r(e=>u(d({},e),{isLoading:!1,error:t instanceof Error?t:new Error("Unknown error")})),w("Error fetching release data:",t)}};M.default.useEffect(()=>{s()},[]);var c=M.default.useCallback(()=>{n();var e=null==(e=null==(e=t.releases)?void 0:e[0])?void 0:e.tag_name;e&&a(e)},[n,t.releases,a]);return M.default.createElement(M.default.Fragment,null,M.default.createElement(X,{title:"Lucid Changelog",onClose:c,isOpen:i},M.default.createElement(oa,{releases:t.releases,isLoading:t.isLoading,error:t.error,currentVersion:e})))},da=()=>(b("Render <Main />"),(0,I.useEffect)(()=>{(()=>{var n=Spicetify.Locale;function r(e){return e.replace(/[{0}{1}«»”“]/g,"").trim()}if(n){r(n.get("playlist.a11y.play")||""),r(n.get("playlist.a11y.pause")||"");var l=n.get("play"),i=n.get("pause"),o=n.get("browse"),s=n.get("playback-control.skip-forward"),c=n.get("playback-control.skip-back"),d=n.get("tracklist.a11y.play")||"",u=n.get("view.web-player-home"),m=n.get("upgrade.tooltip.title")||"Upgrade to Premium";let e,t;["zh-CN","zh-TW","am","fi"].includes(n.getLocale())?[e,t]=d.split("{1}"):[e,t]=d.split("{0}"),e=r(e),t=r(t);var d=n.get("playback-control.enable-repeat"),g=n.get("playback-control.enable-repeat-one"),n=n.get("playback-control.disable-repeat"),p="lucid_button_styles";let a=document.getElementById(p);a||((a=document.createElement("style")).id=p,document.head.appendChild(a)),a.innerHTML=`
.Root__globalNav button[aria-label="${m}"],
.Root__globalNav button[title="${m}"] {
  display: none !important;
}

.main-repeatButton-button[aria-checked="false"],
.player-controls__right button[aria-label*="${d}"]  span{
  -webkit-mask-image: var(--repeat-off-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-off.svg"));
  mask-image: var(--repeat-off-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-off.svg"));
  background-color: var(--spice-subtext);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="mixed"],
.player-controls__right button[aria-label*="${n}"] span {
  -webkit-mask-image: var(--repeat-mixed-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-mixed.svg"));
  mask-image: var(--repeat-mixed-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-mixed.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="true"],
.player-controls__right button[aria-label*="${g}"] span {
  -webkit-mask-image: var(--repeat-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat.svg"));
  mask-image: var(--repeat-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.player-controls__right button[aria-label*="${n}"] svg,
.player-controls__right button[aria-label*="${d}"] svg {
  transform: scale(1.15);
}

.player-controls__right button[aria-label*="${n}"] svg,
.player-controls__right button[aria-label*="${d}"] svg {
  visibility: hidden;
  opacity: 0;
}

.main-repeatButton-button {
  transform: scale(0.65) !important;
}

.player-controls__right, 
.player-controls__left {
    align-items: center;
}

.player-controls__buttons>button[aria-label*="${l}"] span,
.main-playButton-button[aria-label*="${l}"],
.main-playButton-PlayButton>button[aria-label*="${l}"]{
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--play-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/play.svg")) !important;
  mask-image: var(--play-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/play.svg")) !important;
}

.main-playButton-button[aria-label*="${i}"],
.main-playButton-PlayButton>button[aria-label*="${i}"],
.main-playPauseButton-button[aria-label*="${i}"],
.player-controls__buttons>button[aria-label*="${i}"] span {
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--pause-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/pause.svg")) !important;
  mask-image: var(--pause-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/pause.svg")) !important;
}

.Root__globalNav button:is([aria-label="Clear search field"]) {
  background-color: transparent !important;
  border: none !important;
}

button[aria-label="${o}"] path {
  display: none !important;
}

button[aria-label="${o}"] svg {
  -webkit-mask-size: contain;
  mask-size: contain;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-image: var(--compass-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/compass-outline.svg"));
  mask-image: var(--compass-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/compass-outline.svg"));
  background-color: var(--spice-subtext) !important;
  scale: 1.25;
}

.main-repeatButton-button[aria-label="${d}"],
.main-repeatButton-button[aria-label="${n}"],
.main-repeatButton-button[aria-label="${g}"],
{
scale: 0.75 !important;
background-color: var(--spice-subtext) !important;
color: var(--spice-subtext);

svg {
  display: none;
}
}

.player-controls__buttons>button[aria-label*="${l}"] span,
.player-controls__buttons>button[aria-label*="${i}"] span{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  aspect-ratio: 1/1;
}

.main-playPauseButton-button,
.player-controls button[aria-label="${c}"],
.player-controls button[aria-label="${s}"]
{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  min-height: 1rem;
  min-width: 1rem;
  aspect-ratio: 1/1;
  border-radius: 0 !important;
  border: none !important;
  height: var(--button-size, 24px);
  width: var(--button-size, 24px);
  
  svg,
  span {
    display: none;
    visibility: hidden;
  }
}

.player-controls__buttons>button[aria-label*="${l}"] span svg,
.player-controls__buttons>button[aria-label*="${i}"] span svg {
  display: none;
  visibility: hidden;
}

.player-controls button[aria-label="${c}"] span,
.player-controls button[aria-label="${s}"] span {
  opacity: 0;
}

.player-controls button[aria-label="${c}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--prev-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/prev.svg"));
  mask-image: var(--prev-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/prev.svg"));
}

.player-controls button[aria-label="${s}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--next-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/next.svg"));
  mask-image: var(--next-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/next.svg"));
}

.main-yourLibraryX-navLink[aria-label="${u}"] svg,
button[aria-label="${u}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-outline.svg"));
  -webkit-mask-image: var(--home-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-outline.svg"));
  background-color: var(--spice-subtext) !important;
}


.main-yourLibraryX-navLink[aria-label="${u}"].active svg,
.main-globalNav-navLinkActive[aria-label="${u}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-filled-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-filled.svg"));
  -webkit-mask-image: var(--home-filled-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-filled.svg"));
  background-color: var(--spice-text) !important;
}

.main-yourLibraryX-navLink[aria-label="${u}"].active svg {
  path {
display: none !important;
  }

  background-color: var(--spice-accent) !important;
}

#context-menu ul[aria-label*="Add to playlist menu"] {
  p {
max-width: 10rem;
  }
}
`}})(),(()=>{let e=document.getElementById("lucid-background-style");e||((e=document.createElement("style")).id="lucid-background-style",document.head.appendChild(e));var t=document.querySelector("#lyrics-cinema"),t=(t&&ia(t,"#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container",e,5),document.querySelector("#main .Root > div:last-child"));t&&ia(t,'.Root div[data-testid="fullscreen-mode-container"], .Root .npv-main-container',e,15)})()},[]),I.default.createElement(I.default.Fragment,null,I.default.createElement("div",{id:"background-container",className:"background-container",style:{containerType:"normal"}},I.default.createElement(ht,null)),I.default.createElement(at,null,I.default.createElement("div",{id:"modal-container",className:"modal-container",style:{containerType:"normal"}},I.default.createElement(st,null),I.default.createElement(ca,null))),I.default.createElement("div",{id:"state"},I.default.createElement(na,null)),I.default.createElement(ue,null))),ua=e(t()),ma=async function(){try{for(;!(null!=Spicetify&&Spicetify.showNotification&&null!=Spicetify&&Spicetify.Player&&null!=Spicetify&&Spicetify.React&&null!=Spicetify&&Spicetify.Platform);)await new Promise(e=>setTimeout(e,100));let e=document.getElementById("lucid-main");var t;e||((e=document.createElement("div")).id="lucid-main",null!=(t=document.getElementById("main"))&&t.prepend(e)),e&&!e.hasChildNodes()&&Spicetify.ReactDOM.createRoot(e).render(ua.default.createElement(da,null)),console.log("%c Lucid ignited! 🚀","font-weight: bold; font-size: 1.25rem; color: #2196F3; padding: 0.5rem 0;")}catch(e){Spicetify.showNotification("[Lucid] Error Occurred: "+(e instanceof Error?e.message:e),!0),w(e)}};(async()=>{await ma()})()})();