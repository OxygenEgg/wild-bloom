(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var A,e,t,O=Object.create,j=Object.defineProperty,D=Object.defineProperties,F=Object.getOwnPropertyDescriptor,V=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertyNames,z=Object.getOwnPropertySymbols,H=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,G=(e,t,a)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,u=(e,t)=>{for(var a in t=t||{})q.call(t,a)&&G(e,a,t[a]);if(z)for(var a of z(t))Z.call(t,a)&&G(e,a,t[a]);return e},d=(e,t)=>D(e,V(t)),a=(e,t,a)=>(a=null!=e?O(H(e)):{},((t,a,l,r)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let e of T(a))q.call(t,e)||e===l||j(t,e,{get:()=>a[e],enumerable:!(r=F(a,e))||r.enumerable});return t})(!t&&e&&e.__esModule?a:j(a,"default",{value:e,enumerable:!0}),e)),l=(A={"external-global-plugin:react"(e,t){t.exports=Spicetify.React}},function(){return e||(0,A[T(A)[0]])((e={exports:{}}).exports,e),e.exports}),W=e=>{let l,r=new Set;var t=(e,a)=>{e="function"==typeof e?e(l):e;if(!Object.is(e,l)){let t=l;l=(null!=a?a:"object"!=typeof e||null===e)?e:Object.assign({},l,e),r.forEach(e=>e(l,t))}},a=()=>l,n={setState:t,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))};let i=l=e(t,a,n);return n},J=e=>e?W(e):W,X=a(l(),1),Q=e=>e,Y=e=>{let l=J(e);e=e=>{return[t,a=Q]=[l,e],e=X.default.useSyncExternalStore(t.subscribe,()=>a(t.getState()),()=>a(t.getInitialState())),X.default.useDebugValue(e),e;var t,a};return Object.assign(e,l),e},K=e=>e?Y(e):Y,ee={underMainBackgroundImage:"",pageCategory:"other",artworkData:{nowPlayingArtURL:"",currentPageURI:"",currentPageArtURL:""},rootStyle:document.body.style||document.documentElement.style},m=K(e=>d(u({},ee),{updateArtworkData:t=>e(e=>d(u({},e),{artworkData:u(u({},e.artworkData),t)})),setPageCategory:t=>e(e=>d(u({},e),{pageCategory:t})),setUnderMainViewBackgroundImage:t=>e(e=>d(u({},e),{underMainBackgroundImage:t})),setIsCustomControls:t=>e(e=>d(u({},e),{isCustomControls:t})),setRootStyle:t=>e(e=>d(u({},e),{rootStyle:t}))})),te=a=>e=>{try{let t=a(e);return t instanceof Promise?t:{then(e){return te(e)(t)},catch(e){return this}}}catch(t){return{then(e){return this},catch(e){return te(e)(t)}}}},ae=(p,f)=>(a,l,e)=>{let r={storage:((e,a)=>{let l;try{l=e()}catch(e){return}return{getItem:e=>{var t=e=>null===e?null:JSON.parse(e,null==a?void 0:a.reviver),e=null!=(e=l.getItem(e))?e:null;return e instanceof Promise?e.then(t):t(e)},setItem:(e,t)=>l.setItem(e,JSON.stringify(t,null==a?void 0:a.replacer)),removeItem:e=>l.removeItem(e)}})(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...f},n=!1,i=new Set,o=new Set,s=r.storage;if(!s)return p((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),a(...e)},l,e);let c=()=>{var e=r.partialize({...l()});return s.setItem(r.name,{state:e,version:r.version})},u=e.setState,d=(e.setState=(e,t)=>{u(e,t),c()},p((...e)=>{a(...e),c()},l,e));e.getInitialState=()=>d;let m,t=()=>{var e;if(s){n=!1,i.forEach(e=>e(null!=(e=l())?e:d));let t=(null==(e=r.onRehydrateStorage)?void 0:e.call(r,null!=(e=l())?e:d))||void 0;return te(s.getItem.bind(s))(r.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===r.version)return[!1,e.state];if(r.migrate)return[!0,r.migrate(e.state,e.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var[e,t]=e;if(m=r.merge(t,null!=(t=l())?t:d),a(m,!0),e)return c()}).then(()=>{null!=t&&t(m,void 0),m=l(),n=!0,o.forEach(e=>e(m))}).catch(e=>{null!=t&&t(void 0,e)})}};return e.persist={setOptions:e=>{r={...r,...e},e.storage&&(s=e.storage)},clearStorage:()=>{null!=s&&s.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>t(),hasHydrated:()=>n,onHydrate:e=>(i.add(e),()=>{i.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},r.skipHydration||t(),m||d},le=console.log,re=console.debug,ne=console.error,ie=console.warn,oe={prefix:"font-weight: bold; color: #4DB6AC; font-size: 0.85rem;",error:"color: #dc3545;",warn:"color: #ffc107;",debug:"color: #17a2b8;",info:""},r=(e,t,...a)=>{var l={info:le,debug:re,error:ne,warn:ie}[e],e=oe[e];l("%c[Lucid] %c"+t,oe.prefix,e,...a)},p=(e,...t)=>r("info",e,...t),f=(e,...t)=>r("debug",e,...t),k=(e,...t)=>r("error",e,...t),se=(e,...t)=>r("warn",e,...t),ce={backgroundMode:"static",backgroundStyles:{solid:{opacity:1,backgroundColor:"var(--spice-main)"},static:{blur:32,opacity:1,saturation:1.1,contrast:1.2,brightness:.6,backgroundColor:"var(--spice-main)"},animated:{blur:32,time:45,opacity:1,saturation:1.1,contrast:1.2,brightness:.6,backgroundColor:"var(--spice-main)"}},grainEffect:"stary",isDynamicColor:!1,isScrollMode:!0,isCustomBackground:!1,customBackgroundURL:"",playlistImageMode:"inherit",playbarMode:"default",playbarStyles:{compact:{opacity:1,saturation:1.1,contrast:1.2,brightness:.8,borderRadius:8,backdropBlur:32,paddingX:6,backgroundColor:"rgba(var(--spice-rgb-card), 0.5)"},default:{opacity:1,paddingX:6,saturation:1.1,contrast:1.2,borderRadius:8,brightness:.8,backdropBlur:32,backgroundColor:"rgba(var(--spice-rgb-card), 0.5)"}},fontSettings:{title:{fontFamily:"Poppins",url:""},body:{fontFamily:"Poppins",url:""}},playlistViewMode:"card"},ue="playlist-art-image-",de="playlist-view-",o="1.2.46"<=Spicetify.Platform.version,me="light"===(null==Spicetify?void 0:Spicetify.Config.color_scheme)||!1,pe=!(!Spicetify.Platform||"Windows"!==Spicetify.Platform.operatingSystem)||!(null==(t=null==(t=Spicetify.Platform)?void 0:t.PlatformData)||!t.os_name)&&Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"),fe=!(!document.querySelector(".globalNav")&&!document.querySelector(".Root__globalNav")),ge=!!document.getElementById("customControls")&&(null!=(t=document.querySelector(".lucid-transperent-window-controls"))&&t.remove(),!0),g=K(ae(r=>d(u({},ce),{updateFontSettings:(t,a,l)=>r(e=>({fontSettings:d(u({},e.fontSettings),{[t]:d(u({},e.fontSettings[t]),{[a]:l})})})),setIsScrollMode:e=>r(()=>({isScrollMode:e})),setIsCustomBackground:e=>r(()=>({isCustomBackground:e})),setCustomBackgroundURL(e){r(()=>({customBackgroundURL:e}))},setBackgroundMode:e=>r(()=>({backgroundMode:e})),setFontSettings:e=>r(()=>({fontSettings:e})),setGrainEffect:e=>r(()=>({grainEffect:e})),setPlaylistImageMode:e=>r(()=>({playlistImageMode:e})),setPlaybarMode:e=>r(()=>({playbarMode:e})),setPlaylistViewMode:e=>r(()=>({playlistViewMode:e})),setDynamicColor:e=>r(()=>({isDynamicColor:e})),updateBackgroundStyles:(t,a,l)=>{r(e=>d(u({},e),{backgroundStyles:d(u({},e.backgroundStyles),{[t]:d(u({},e.backgroundStyles[t]),{[a]:l})})}))},updatePlaybarStyles:(t,a,l)=>{r(e=>d(u({},e),{playbarStyles:d(u({},e.playbarStyles),{[t]:d(u({},e.playbarStyles[t]),{[a]:l})})}))},resetSettings:()=>{r(ce)}}),{name:"lucid-settings"})),ye=(e,t,a)=>"#"+(e<<16|t<<8|a).toString(16).padStart(6,"0"),be=(e,t)=>d(u({},e),{r:Math.min(255,Math.round(e.r+(255-e.r)*t)),g:Math.min(255,Math.round(e.g+(255-e.g)*t)),b:Math.min(255,Math.round(e.b+(255-e.b)*t)),hex:ye(Math.min(255,Math.round(e.r+(255-e.r)*t)),Math.min(255,Math.round(e.g+(255-e.g)*t)),Math.min(255,Math.round(e.b+(255-e.b)*t)))});async function ve(){var e;try{var t=(await Spicetify.colorExtractor(null==(e=Spicetify.Player.data)?void 0:e.item.uri)).LIGHT_VIBRANT,a=(e=>{let t=0,a=0,l=0;return 4==e.length?(t=parseInt(e[1]+e[1],16),a=parseInt(e[2]+e[2],16),l=parseInt(e[3]+e[3],16)):7==e.length&&(t=parseInt(e[1]+e[2],16),a=parseInt(e[3]+e[4],16),l=parseInt(e[5]+e[6],16)),{r:t,g:a,b:l}})(t),l={r:a.r,g:a.g,b:a.b,hex:t},r=l,n=l,i=l;return console.warn(l),{baseColor:r,secondaryColor:n,tertiaryColor:i}}catch(e){return k("Error extracting colors: ",e),e}}var he=null;async function we(s,e,t){return e&&t?new Promise(o=>{he&&clearTimeout(he),he=setTimeout(async()=>{try{var e,t,a,l=await ve();l instanceof Error?(k("Error extracting colors: "+l.message),o(null)):(e=({baseColor:r,secondaryColor:n,tertiaryColor:i}=[l][0],{"progress-bar":be(n,.6),accent:be(r,.4),button:be(i,.4),"button-active":be(i,.4),primary:r,secondary:n,tertiary:i}),t=s,a=e,a=`:root {${Object.entries(a).map(([e,t])=>`
--spice-${e}: ${t.hex} !important;
--spice-rgb-${e}: ${t.r}, ${t.g}, ${t.b} !important;`).join("")}
}`,a+=":root{\nwill-change: --spice-accent,--spice-rgb-accent,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-progress-bar,--spice-rgb-progress-bar,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;\ntransition: all 0.5s ease-in-out;\n}",t.textContent=a,o(l))}catch(e){k("Error saving colors to style: ",e instanceof Error?e.message:e),o(null)}var r,n,i},200)}):null}var ke=a(l()),Ee=()=>{let e=g().isDynamicColor,t=m().artworkData,a=ke.default.useRef(null),l=ke.default.useRef(null);ke.default.useEffect(()=>(a.current=document.createElement("style"),a.current.id="lucid_dynamic_colors",document.head.appendChild(a.current),()=>{a.current&&document.head.removeChild(a.current)}),[]),ke.default.useEffect(()=>{e?e&&t.nowPlayingArtURL!==l.current&&(null!=a&&a.current&&e&&t.nowPlayingArtURL&&we(a.current,e,t.nowPlayingArtURL).then(()=>{p("Dynamic colors updated!")}).catch(e=>{k("Error updating colors:",e)}),l.current=t.nowPlayingArtURL):(l.current&&(l.current=null),a.current&&(async e=>{e.textContent=":root{\nwill-change: --spice-accent,--spice-rgb-accent,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-progress-bar,--spice-rgb-progress-bar,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;\ntransition: all 0.5s ease-in-out;\n}"})(a.current))},[e,t.nowPlayingArtURL])},Se=a(l()),Ce=()=>(Ee(),Se.default.createElement(Se.default.Fragment,null)),Pe=e=>{try{return new URL(e),!0}catch(e){return!1}},Re=e=>decodeURIComponent((null==(e=null==(e=e.match(/family=([^&:]+)/))?void 0:e[1])?void 0:e.replace(/\+/g," "))||"")||"",Le=a(l()),Me=()=>{let r=g().fontSettings,n=Le.default.useCallback((e,t)=>{document.documentElement.style.setProperty(`--${e}-font-to-use`,t)},[]),t=Le.default.useCallback(e=>{var t,{url:a,fontFamily:l}=r[e];Pe(a)?(t=Re(a),((e,t)=>{let a=document.getElementById(t);a||((a=document.createElement("link")).rel="stylesheet",a.id=t,document.head.appendChild(a)),a.href=e})(a,e+"-font"),n(e,t)):n(e,l)},[r,n]);Le.default.useEffect(()=>{for(var e of Object.keys(r))t(e);f("useFontManager effect ran.")},[r,t])},xe=a(l()),Ne=e=>{(0,xe.useEffect)(()=>{if(e)return document.body.classList.add(e),()=>{document.body.classList.remove(e)}},[e])},Ie=a(l()),Ue=()=>{var e=g().grainEffect;return Ne("grain-"+e),Ie.default.createElement("div",{id:"grainEffect","data-grainEffect":e})},_e=a(l()),Be=()=>(Ne(fe?"global-nav":"control-nav"),_e.default.createElement(_e.default.Fragment,null)),$e=a(l()),Ae=()=>{let{underMainBackgroundImage:t,setUnderMainViewBackgroundImage:a,rootStyle:e}=m(),l=$e.default.useCallback(e=>{var e=e.reduce((e,t)=>{if(e)return e;if("childList"===t.type&&0<t.addedNodes.length){e=t.addedNodes[0];if(e.firstChild instanceof HTMLDivElement)return e.firstChild}return null},null);null!=e&&e.style?(e=e.style.backgroundImage.replace(/url\(['"]?([^'"]*)['"]?\)/i,"$1"),a(e)):null!==t&&a(null)},[a,t]);$e.default.useEffect(()=>{let e=new MutationObserver(l);var t=document.querySelector(".under-main-view");return t&&e.observe(t,{childList:!0}),()=>e.disconnect()},[l]),$e.default.useEffect(()=>(e.setProperty("--under-main-view-art-image",t?`url(${t})`:null),()=>{e.removeProperty("--under-main-view-art-image")}),[t,e])},Oe=async e=>{let t=0;for(;t<=3;)try{var a=await Spicetify.GraphQL.Request({name:"queryArtistOverview",operation:"query",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497",value:null},{uri:e,includePrerelease:!0,locale:null});if(a)return a}catch(e){if(!(e instanceof Error&&e.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3))throw console.error("Error fetching artist metadata:",e),e;t++,se(`Duplicate request detected (getArtistMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(e=>setTimeout(e,1e3))}},je=async e=>{let t=0;for(;t<=3;)try{var a=await Spicetify.GraphQL.Request({name:"getAlbum",operation:"query",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d",value:null},{uri:e,locale:null,offset:0,limit:50});if(a)return a}catch(e){if(!(e instanceof Error&&e.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3))throw console.error("Error fetching album metadata:",e),e;t++,se(`Duplicate request detected (getAlbumMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(e=>setTimeout(e,1e3))}},De=a(l()),Fe=()=>{let{pageCategory:e,rootStyle:o,artworkData:s,updateArtworkData:c}=m(),t=g().playlistImageMode,a=De.default.useCallback(async()=>{var e,t,a,l,r,n=Spicetify.Platform.History.location.pathname,i=(n=n,i=Spicetify.URI.isPlaylistV1OrV2(n),e=Spicetify.URI.isArtist(n),t=Spicetify.URI.isAlbum(n),a=Spicetify.URI.isShow(n),l=Spicetify.URI.isProfile(n),i||e||t||l||a?(l=null==(l=n.match(/\/(?:playlist|artist|album|user|show)\/([^/]+)/))?void 0:l[1])?`spotify:${i?"playlist":e?"artist":t?"album":a?"show":"user"}:`+l:(console.warn("No ID found in pathname:",n),null):null);if(s.currentPageURI!==i){o.setProperty("--artwork-opacity","0");try{i?(r=await(async e=>{var t,a,l,r,n,i,o,s,c,u,d,m,p,f,g,y,b=e.split(":")[1];try{switch(b){case"playlist":case"show":return(null==(t=(await Spicetify.Platform.PlaylistAPI.getMetadata(e)).images.find(e=>e.url))?void 0:t.url)||null;case"artist":var v=await Oe(e);return(null==(n=null==(r=null==(l=null==(a=v.data)?void 0:a.artistUnion.visuals.headerImage)?void 0:l.sources)?void 0:r[0])?void 0:n.url)||(null==(c=null==(s=null==(o=null==(i=v.data)?void 0:i.artistUnion.visuals.avatarImage)?void 0:o.sources)?void 0:s[0])?void 0:c.url)||null;case"album":var h=await je(e);return(null==(m=null==(d=null==(u=h.data)?void 0:u.albumUnion.coverArt.sources)?void 0:d[2])?void 0:m.url)||(null==(g=null==(f=null==(p=h.data)?void 0:p.albumUnion.coverArt.sources)?void 0:f[0])?void 0:g.url)||null;case"user":var w=await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath("/profile/"+e.split(":")[2]).send();return(null==(y=null==w?void 0:w.body)?void 0:y.image_url)||null;default:return null}}catch(e){return k(`Error fetching artwork for ${b}:`,e),null}})(i)||"",c({currentPageArtURL:r,currentPageURI:i})):c({currentPageArtURL:"",currentPageURI:""})}catch(e){console.error("Error updating artwork:",e),c({currentPageArtURL:"",currentPageURI:""})}finally{setTimeout(()=>o.setProperty("--artwork-opacity","1"),500)}}},[s.currentPageURI,o,c]);De.default.useEffect(()=>{if(s.currentPageArtURL?(o.setProperty("--playlist-art-image",`url(${s.currentPageArtURL})`),p("Updated Playlist Artwork URL to "+s.currentPageArtURL)):s.currentPageURI&&"other"!==e&&(k("No artwork URL found for URI: "+s.currentPageURI),o.setProperty("--playlist-art-image","none")),"inherit"===t){let e=Spicetify.Platform.History.listen(a);return a(),()=>{e()}}},[t,s.currentPageArtURL,s.currentPageURI,e,o,a]),De.default.useEffect(()=>{s.nowPlayingArtURL&&(o.setProperty("--now-playing-art-image",`url(${s.nowPlayingArtURL})`),p("Updated Now Playing Art View: "+s.nowPlayingArtURL))},[s.nowPlayingArtURL,o]),De.default.useEffect(()=>{let e=async()=>{var e=await(async()=>{for(var e;null==(e=null==Spicetify?void 0:Spicetify.Player)||!e.data;)await new Promise(e=>setTimeout(e,100));try{return Spicetify.Player.data.item.metadata.image_xlarge_url||Spicetify.Player.data.item.metadata.image_large_url||Spicetify.Player.data.item.metadata.image_url||Spicetify.Player.data.item.metadata.image_small_url||""}catch(e){k("Error updating getting URL: ",e)}})();c({nowPlayingArtURL:e})};return e(),Spicetify.Player.addEventListener("songchange",e),()=>{Spicetify.Player.removeEventListener("songchange",e)}},[c])},Ve=a(l()),Te=()=>{let{playbarMode:t,playbarStyles:a}=g(),l=(Ne("playbar-"+t),Ve.default.useRef({}));return Ve.default.useEffect(()=>{var e={"--background-color":null==(e=a[t])?void 0:e.backgroundColor,"--opacity":null==(e=a[t])?void 0:e.opacity,"--brightness":null==(e=a[t])?void 0:e.brightness,"--contrast":null==(e=a[t])?void 0:e.contrast,"--padding-x":`${(null==(e=a[t])?void 0:e.paddingX)||0}px`,"--padding-y":`${(null==(e=a[t])?void 0:e.paddingY)||0}px`,"--time":`${(null==(e=a[t])?void 0:e.time)||0}s`,"--blur":`${(null==(e=a[t])?void 0:e.blur)||0}px`,"--border-radius":`${(null==(e=a[t])?void 0:e.borderRadius)||8}px`,"--saturation":null==(e=a[t])?void 0:e.saturation,"--backdrop-blur":`${(null==(e=a[t])?void 0:e.backdropBlur)||0}px`},e=(l.current=e,document.querySelector(".Root__now-playing-bar"));e?e.style.cssText=Object.entries(l.current).map(([e,t])=>e+`: ${t};`).join(" "):k("Playbar element not found!")},[t,a]),l.current},ze=a(l()),He=()=>{let{pageCategory:e,setPageCategory:a}=m();Ne(e),ze.default.useEffect(()=>{let e=()=>{var e=Spicetify.Platform.History.location.pathname;a((e=e,Spicetify.URI.isPlaylistV1OrV2(e)?"playlist":Spicetify.URI.isArtist(e)?"artist":Spicetify.URI.isAlbum(e)?"album":Spicetify.URI.isGenre(e)?"genre":Spicetify.URI.isShow(e)?"show":Spicetify.URI.isProfile(e)?"profile":Spicetify.URI.isConcert(e)||Spicetify.URI.isArtistConcerts(e)?"concert":"other"))},t=(e(),Spicetify.Platform.History.listen(()=>{e()}));return()=>{t()}},[a])},n=a(l()),qe=n.default.memo(()=>(f("Render <MainStateManager />"),He(),Me(),Te(),Ae(),Fe(),n.default.createElement(n.default.Fragment,null,n.default.createElement(Ce,null),n.default.createElement(Ue,null),n.default.createElement(Be,null)))),i=a(l()),Ze=()=>i.default.createElement("div",{className:"animated-background-container"},i.default.createElement("div",{className:"back"}),i.default.createElement("div",{className:"backleft"}),i.default.createElement("div",{className:"backright"}),i.default.createElement("div",{className:"front"})),Ge=a(l()),We=()=>Ge.default.createElement("div",{className:"solid-background"}),Je=a(l()),Xe=()=>{var{customBackgroundURL:e,isCustomBackground:t}=g(),a=m().artworkData,t=t?e||"":(null==a?void 0:a.nowPlayingArtURL)||"";return Je.default.createElement("div",{className:"static-background",style:{backgroundImage:`url(${t})`}})},s=a(l()),Qe=s.default.memo(()=>{f("Render <BackgroundManager />");let{backgroundMode:t,backgroundStyles:a}=g(),[e,l]=s.default.useState({});return s.default.useEffect(()=>{var e;l({"--background-color":null==(e=a[t])?void 0:e.backgroundColor,"--opacity":null==(e=a[t])?void 0:e.opacity,"--brightness":null==(e=a[t])?void 0:e.brightness,"--contrast":null==(e=a[t])?void 0:e.contrast,"--time":`${(null==(e=a[t])?void 0:e.time)||0}s`,"--blur":`${(null==(e=a[t])?void 0:e.blur)||0}px`,"--saturation":null==(e=a[t])?void 0:e.saturation,"--backdrop-blur":`${(null==(e=a[t])?void 0:e.backdropBlur)||0}px`})},[t,a]),s.default.createElement("div",{className:"background-wrapper",style:e},"animated"===t&&s.default.createElement(Ze,null),"static"===t&&s.default.createElement(Xe,null),"solid"===t&&s.default.createElement(We,null))}),c=a(l()),Ye=({releases:e,isLoading:t,error:a})=>t?c.default.createElement("div",null,"Loading release data..."):a?c.default.createElement("div",null,"Error fetching release data: ",a.message):e?c.default.createElement("div",{className:"lucid-changelog",id:"lucid-changelog"},e.map(e=>c.default.createElement("div",{key:e.tag_name,className:"release"},c.default.createElement("button",{className:"release-button",type:"button",onClick:()=>window.open(e.html_url,"_blank")},"View on GitHub"),e.body&&c.default.createElement("div",{className:"release-content",dangerouslySetInnerHTML:{__html:e.body}})))):c.default.createElement("div",null,"No release data found."),y=a(l()),Ke=y.default.memo(({title:e,children:t,headingChild:a,onClose:l,isOpen:r=!1})=>r?y.default.createElement("div",{className:"modal-container"},y.default.createElement("div",{className:"modal-overlay "+(r&&"open"),style:{zIndex:20},onClick:l}),y.default.createElement("dialog",{open:r,className:"modal-section "+(r&&"open"),"aria-label":e,"aria-modal":"true"},y.default.createElement("div",{className:"main-embedWidgetGenerator-container"},y.default.createElement("div",{className:"main-trackCreditsModal-header"},y.default.createElement("h1",{className:"main-type-alto"},e),a&&y.default.createElement("div",null,a),y.default.createElement("button",{type:"button","aria-label":"Close",className:"main-trackCreditsModal-closeBtn",onClick:()=>l()},y.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},y.default.createElement("title",null,"Close"),y.default.createElement("path",{d:"M31.098 29.794L16.955 15.65 31.097 1.51 29.683.093 15.54 14.237 1.4.094-.016 1.508 14.126 15.65-.016 29.795l1.414 1.414L15.54 17.065l14.144 14.143",fill:"currentColor","fill-rule":"evenodd"})))),y.default.createElement("div",{className:"modal-contents"},y.default.createElement("main",{className:"modal-wrapper"},t))))):null),b=a(l()),et={settings:!1,changelog:!1},{ModalContextProvider:tt,useModal:at}=(()=>{let n=b.default.createContext(null);return{ModalContextProvider:({children:e})=>{let[a,l]=b.default.useState(et),t=b.default.useCallback(t=>({isOpen:a[t],openModal:b.default.useCallback(()=>{l(e=>d(u({},e),{[t]:!0}))},[t]),closeModal:b.default.useCallback(()=>{l(e=>d(u({},e),{[t]:!1}))},[t])}),[a]);var r=b.default.useMemo(()=>t,[t]);return b.default.createElement(n.Provider,{value:r},e)},useModal:e=>{var t=b.default.useContext(n);if(t)return t(e);throw new Error("Wrap Element with ModalContextProvider")}}})(),lt=a(l()),v=a(l()),rt=v.default.memo(({currentVersion:e})=>{f("Render <ChangeLogManager />");let[t,r]=v.default.useState({isLoading:!0,error:null,releases:null}),[n,a]=((t,a)=>{let[e,l]=lt.default.useState(()=>{var e;return"undefined"!=typeof window&&(e=window.localStorage.getItem(t))?JSON.parse(e):a});return lt.default.useEffect(()=>{"undefined"!=typeof window&&window.localStorage.setItem(t,JSON.stringify(e))},[t,e]),[e,l]})("lucid:previousVersion",null),{closeModal:l,isOpen:i,openModal:o}=at("changelog"),s=v.default.useCallback(async()=>{p("Fetching release data..."),r(e=>d(u({},e),{isLoading:!0}));try{var e=await fetch("https://api.github.com/repos/sanoojes/spicetify-lucid/releases");if(!e.ok)throw new Error("HTTP error! status: "+e.status);var t=await e.json(),a=(p("Fetched release data:",t),await Promise.all(t.map(async e=>d(u({},e),{body:await(async(e,t,a)=>{try{var l={text:e,context:t+"/"+a,mode:"gfm"},r=await fetch("https://api.github.com/markdown",{method:"POST",body:JSON.stringify(l)});if(r.ok)return await r.text();throw new Error("HTTP error! status: "+r.status)}catch(e){return console.error("Error parsing markdown:",e),null}})(e.body,"sanoojes","spicetify-lucid")||""})))),l=(r({isLoading:!1,error:null,releases:a}),t[0].tag_name);null!==n&&l===n||(p("Opening changelog modal because new version detected"),o())}catch(t){r(e=>d(u({},e),{isLoading:!1,error:t instanceof Error?t:new Error("Unknown error")})),k("Error fetching release data:",t)}},[o,n]);v.default.useEffect(()=>{s()},[]);var c=v.default.useCallback(()=>{l();var e=null==(e=null==(e=t.releases)?void 0:e[0])?void 0:e.tag_name;e&&a(e)},[l,t.releases,a]);return v.default.createElement(v.default.Fragment,null,v.default.createElement(Ke,{title:"Lucid Changelog",onClose:c,isOpen:i},v.default.createElement(Ye,{releases:t.releases,isLoading:t.isLoading,error:t.error,currentVersion:e})))}),h=a(l()),w=({options:e,selectedValue:a,onSelect:l,label:t})=>{let[r,n]=h.default.useState(!1),i=h.default.useRef(null);var o=h.default.useRef(null);h.default.useEffect(()=>{let e=e=>{i.current&&!i.current.contains(e.target)&&n(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);return h.default.createElement("div",{className:"dropdown-container",ref:i},h.default.createElement("button",{className:"dropdown-button "+(r&&"open"),onClick:()=>{n(!r)},"aria-label":"Toggle dropdown menu",type:"button"},t||a,h.default.createElement("span",{className:"dropdown-arrow"},h.default.createElement("svg",{role:"img","aria-labelledby":"title",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},h.default.createElement("span",{id:"title"},"Down"),h.default.createElement("path",{d:"M4.293 8.293a1 1 0 0 1 1.414 0L12 14.586l6.293-6.293a1 1 0 1 1 1.414 1.414l-7 7a1 1 0 0 1-1.414 0l-7-7a1 1 0 0 1 0-1.414Z",fill:"#ffffff"})))),r&&h.default.createElement("ul",{className:"dropdown-menu","aria-label":"Dropdown menu",ref:o},e.map(t=>h.default.createElement("li",{key:t.value,onClick:()=>{return e=t.value,l(e),void n(!1);var e},className:a===t.value?"dropdown-item selected":"dropdown-item",tabIndex:-1},t.label))))},E=a(l()),S=({title:e,tooltip:t,selectedValue:a,children:l})=>E.default.createElement("div",{className:"card"},E.default.createElement("div",{className:"title-container"},E.default.createElement("div",{className:"title-wrapper"},e&&E.default.createElement("h5",{className:"title"},e),t&&E.default.createElement("div",{className:"tooltip-container"},E.default.createElement("div",{className:"tooltip"},E.default.createElement("span",{className:"tooltip-icon"},E.default.createElement("svg",{role:"img","aria-label":"Tooltip icon",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},E.default.createElement("path",{d:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z",fill:"currentColor"}))),E.default.createElement("span",{className:"tooltip-content"},t)))),a&&E.default.createElement("p",{className:"selected-value"},"Selected: ",a)),E.default.createElement("div",{className:"children-wrapper"},l)),nt=a(l()),it=({children:e})=>nt.default.createElement(nt.default.Fragment,null,nt.default.createElement("div",{className:"cards-wrapper"},e)),C=a(l()),ot=C.default.memo(({name:e,step:t,type:a,value:l,placeholder:r,onChange:n,isURL:i=!1,expectURL:o=!1})=>{let[s,c]=(0,C.useState)(null);return C.default.createElement("div",{className:"custom-input-container"},s&&C.default.createElement("span",{className:"error-message"},s),C.default.createElement("input",{type:a,name:e,step:t,placeholder:r,value:void 0!==l?null==l?void 0:l.toString():"",className:"input "+(i?"url":null),onChange:e=>{var t=e.target.value;(i||o)&&(t&&!Pe(t)?c("Please enter a valid URL."):c(null)),n(e)}}))}),st=a(l()),ct=({onChange:e,currentValue:t})=>st.default.createElement("div",{className:"slider-wrapper"},st.default.createElement("label",{className:"switch"},st.default.createElement("input",{"aria-label":"toggleSwtich",type:"checkbox",checked:t,onChange:()=>{e(!t)}}),st.default.createElement("span",{className:"slider round"}))),P=a(l()),ut=P.default.memo(()=>{let{backgroundMode:a,isDynamicColor:e,setDynamicColor:t,customBackgroundURL:l,setCustomBackgroundURL:r,backgroundStyles:n,setBackgroundMode:i,updateBackgroundStyles:o,isCustomBackground:s,setIsCustomBackground:c}=g();var u=(0,P.useMemo)(()=>[{label:"Animated",value:"animated"},{label:"Static",value:"static"},{label:"Solid",value:"solid"}],[]);return P.default.createElement(P.default.Fragment,null,P.default.createElement(S,{title:"Set Background",selectedValue:(()=>{switch(a){case"animated":return"Animated Background";case"static":return"Static Background";case"solid":return"Solid Background";default:return}})()},P.default.createElement(w,{options:u,selectedValue:a,onSelect:e=>{i(e)},label:"Select an option"})),n[a]&&Object.entries(n[a]).map(([t,e])=>P.default.createElement(S,{key:t,title:"Set "+("backgroundColor"===t?"background color":"backdropBlur"===t?"backdrop blur":"borderRadius"===t?"border radius":t)},P.default.createElement(ot,{type:"backgroundColor"===t?"text":"number",name:t,step:.01,value:e,onChange:e=>((e,t)=>{e=e.target.value.trim();o(a,t,e)})(e,t)}))),"static"===a&&P.default.createElement(it,null,P.default.createElement(S,{title:"Set Static Background URL"},P.default.createElement(ct,{currentValue:s,onChange:e=>c(e)})),s&&P.default.createElement(S,{title:"Enter your custom url"},P.default.createElement(ot,{name:"Custom Url",onChange:e=>{e=e.target.value;r(e)},placeholder:"Enter custom url here",type:"text",value:l,isURL:!0}))),P.default.createElement(S,{title:"Dynamic Color (Experimental)"},P.default.createElement(ct,{currentValue:e,onChange:e=>t(e)})))}),R=a(l()),dt=()=>R.default.createElement("div",null,R.default.createElement("div",null,R.default.createElement("img",{width:"12rem",height:"15rem",src:"https://sanooj.is-a.dev/Spicetify-Lucid/assets/tooltip/font-url.png",alt:"google font url img",style:{width:"12rem",height:"15rem",borderRadius:"4px"}})),R.default.createElement("div",null,R.default.createElement("h4",null,"Usage:"),R.default.createElement("li",null,"Font Name (If Installed)"),R.default.createElement("li",null,"URL (Google Fonts)"))),mt=a(l()),pt=({fontFamily:e,fontUrl:t,onFontChange:a})=>{let[l,r]=mt.default.useState(t||e);return mt.default.createElement("div",null,mt.default.createElement(ot,{name:"Font Family",onChange:e=>{r(e.target.value),a(e.target.value)},placeholder:"Enter Font Family Name or Google Fonts link",type:"text",value:l}))},L=a(l()),ft=()=>{let{fontSettings:a,updateFontSettings:n}=g();return L.default.createElement(L.default.Fragment,null,["title","body"].map(r=>{var{fontFamily:e,url:t}=a[r];return L.default.createElement(S,{key:r,title:`${"title"===r?"Title":"Body"} Font Family`,selectedValue:e||"Default Font (Spotify Mix)",tooltip:L.default.createElement(dt,null)},L.default.createElement(pt,{fontFamily:e,fontUrl:t,onFontChange:e=>{return t=r,a=Pe(e=e),l=a?Re(e):e,n(t,"fontFamily",l),void n(t,"url",a?e:"");var t,a,l}}))}))},gt=a(l()),yt=[{label:"Stary",value:"stary"},{label:"Default",value:"default"},{label:"None",value:"none"}],bt=()=>{let{grainEffect:e,setGrainEffect:t}=g();return gt.default.createElement(S,{title:"Set Grains",selectedValue:e},gt.default.createElement(w,{options:yt,onSelect:e=>{t(e)},selectedValue:e}))},M=a(l()),vt=()=>{let{playbarMode:a,setPlaybarMode:t,playbarStyles:e,updatePlaybarStyles:l}=g();return M.default.createElement(M.default.Fragment,null,M.default.createElement(S,{title:"Set Playbar Mode",selectedValue:a},M.default.createElement(w,{options:[{label:"Compact",value:"compact"},{label:"Default",value:"default"}],onSelect:e=>{t(e)},selectedValue:a})),Object.entries(e[a]||{}).map(([t,e])=>M.default.createElement(S,{key:t,title:"Set "+(e=>{switch(e){case"backgroundColor":return"background color";case"backdropBlur":return"backdrop blur";case"borderRadius":return"border radius";default:return e}})(t)},M.default.createElement(ot,{type:"backgroundColor"===t?"text":"number",name:t,step:.01,value:e,onChange:e=>((e,t)=>{e=e.target.value.trim();l(a,t,e)})(e,t)}))))},x=a(l()),ht=()=>{let{playlistViewMode:e,playlistImageMode:t,setPlaylistViewMode:a,setPlaylistImageMode:l,isScrollMode:r,setIsScrollMode:n}=g();return x.default.createElement(x.default.Fragment,null,x.default.createElement(S,{title:"Set View Mode",selectedValue:e},x.default.createElement(w,{options:[{label:"Default",value:"default"},{label:"Compact",value:"compact"},{label:"Card",value:"card"}],onSelect:e=>{a(e)},selectedValue:e})),x.default.createElement(S,{title:"Set Background Image",selectedValue:t},x.default.createElement(w,{options:[{label:"None",value:"none"},{label:"Playlist Art Image",value:"inherit"},{label:"Now Playing",value:"now-playing"}],onSelect:e=>{l(e)},selectedValue:t})),x.default.createElement(S,{title:"Scroll Background Image"},x.default.createElement(ct,{currentValue:r,onChange:n})))},wt=a(l()),kt=()=>{let e=g().resetSettings;return wt.default.createElement(S,{title:"Reset to Default"},wt.default.createElement("button",{type:"button",className:"button reset-button",onClick:()=>{window.confirm("Are you sure you want to reset all settings to their default values? This action cannot be undone.")&&e()}},"Reset"))},N=a(l()),Et=({title:e,description:t,children:a})=>N.default.createElement("div",{className:"setting-section"},N.default.createElement("div",{className:"heading-wrapper"},N.default.createElement("h3",{className:"title"},e),t&&N.default.createElement("p",{className:"description"},t)),N.default.createElement(it,null,a)),I=a(l()),St=I.default.memo(()=>{let e=I.default.useMemo(()=>[{key:"background",title:"Background",description:"Customize your theme's background.",content:I.default.createElement(ut,null)},{key:"grains",title:"Grains",description:"Set your grain texture.",content:I.default.createElement(bt,null)},{key:"playlistView",title:"Playlist View",description:"Configure your playlist view.",content:I.default.createElement(ht,null)},{key:"playbar",title:"Playbar",description:"Configure your playbar.",content:I.default.createElement(vt,null)},{key:"font",title:"Font",description:"Select your desired font.",content:I.default.createElement(ft,null)},{key:"reset",title:"Reset Settings",description:"Reset to default settings.",content:I.default.createElement(kt,null)}],[]),[t,a]=I.default.useState("all");var{isOpen:l,closeModal:r}=at("settings");let n=e=>{a(e)};return I.default.createElement(Ke,{title:"Lucid Settings",onClose:r,isOpen:l},I.default.createElement("div",{className:"settings-navigation-container"},I.default.createElement("div",{className:"navigation"},I.default.createElement("button",{type:"button",onClick:()=>n("all"),className:"all"===t?"active":""},"All"),e.map(e=>I.default.createElement("button",{type:"button",key:e.key,onClick:()=>n(e.key),className:t===e.key?"active":""},e.title)))),I.default.createElement("div",{className:"sections-container"},("all"===t?e:e.filter(e=>e.key===t)).map(e=>I.default.createElement("div",{className:"section-wrapper",key:e.key,id:e.key},I.default.createElement(Et,{title:e.title,description:e.description},e.content)))))}),Ct=a(l()),Pt=({onClick:t})=>{Ct.default.useEffect(()=>{let e=new Spicetify.Topbar.Button("Lucid Settings",'<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="#ffffff"/></svg>',t,!1,!0);return()=>{e.element.remove()}},[t])},Rt=a(l()),Lt=({onClick:t})=>{(0,Rt.useEffect)(()=>{let e=new Spicetify.Menu.Item("Lucid Settings",!1,t,'<svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="#fff"/></svg>');return e.register(),()=>{e.deregister()}},[t])},Mt=a(l()),xt=Mt.default.memo(()=>{f("Render <SettingsManager />");var{isOpen:e,openModal:t}=at("settings");return(o?Pt:Lt)({onClick:t}),Mt.default.createElement(Mt.default.Fragment,null,e&&Mt.default.createElement(St,null))}),Nt=(e,t,a=1,l=0,r=Number.POSITIVE_INFINITY)=>Math.max(l,Math.min(e*(t+a-1),r)),It=a(l()),Ut=It.default.memo(()=>{let n=It.default.useRef(null),i=m().rootStyle;return It.default.useEffect(()=>{async function e(){if(!ge&&pe){var e=o?32:64,t=(t=window.innerWidth,window.outerWidth/t),a=window.innerWidth/window.outerWidth,t=Math.round((100*t)**.912872807*100/100-(o?0:3)),l=t;try{null!=(r=null==Spicetify?void 0:Spicetify.CosmosAsync)&&r.post&&await Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:l}),p(`Control height set to ${l}px`)}catch(e){k("Error setting control height: "+l)}await 0;var r=Nt(64,a,1),l=Nt(135,a,1);i.setProperty("--top-bar-padding-start",r+"px"),i.setProperty("--top-bar-padding-end",l+"px"),!pe||ge||me||(l=o?Nt(e,a,1):e,e=Nt(135,a,1),n.current&&(n.current.style.setProperty("--transperent-controls-top-offset",`${o?t/4:0}px`),n.current.style.height=l+"px",n.current.style.width=e+"px"))}var t}return setTimeout(e,1e3),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[i]),It.default.createElement("div",{ref:n,className:"lucid-transperent-window-controls"})}),U=a(l()),_t=U.default.memo(()=>U.default.createElement(U.default.Fragment,null,pe?U.default.createElement("div",{id:"transperent-controls-container",className:"transperent-controls-container",style:{containerType:"normal"}},U.default.createElement(Ut,null)):null)),_=a(l()),Bt=()=>{let{playlistViewMode:e,playlistImageMode:t,isScrollMode:r}=g(),{pageCategory:n,underMainBackgroundImage:i}=m(),o=_.default.useRef(null),s=_.default.useRef(null),a=(_.default.useEffect(()=>(document.body.classList.add(ue+t,de+e),()=>{document.body.classList.remove(de+e,ue+t)}),[e,t]),_.default.useCallback(e=>{var t,a=o.current,l=s.current;a&&l&&(t=.03*(e=Math.min(e.scrollTop,window.innerHeight))+("artist"===n||i?0:4),l.style.setProperty("--blur",t+"px"),a.style.transform=`translateY(${r?-e:0}px)`,a.style.setProperty("--scroll",""+e/1e3))},[r,n,i]));return _.default.useEffect(()=>{let t=document.querySelector(".Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport]");if(t){let e=()=>a(t);return e(),t.addEventListener("scroll",e,{passive:!0}),()=>t.removeEventListener("scroll",e)}},[a]),_.default.createElement("span",{id:"playlistArtContainer",className:`playlist-art-container ${e} `+t,"data-playlist-view-mode":e,ref:o},_.default.createElement("div",{className:"background",ref:s}),_.default.createElement("div",{className:"overlay",style:{height:"100%",width:"100%",position:"absolute"}}))},$t=a(l());function At(e,t){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: ${t} !important; }
  `}function Ot(e){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: -1 !important; }
  `}function jt(t,a,l,r){let n=!1,i=null;new MutationObserver(()=>{var e=t.querySelector(a);e!==i&&(e&&!n?(p("Applying background z-index: "+r),n=!0,At(l,r)):n&&(p("Removing background z-index: "+r),n=!1,document.querySelector("#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container")?At(l,6):Ot(l)),i=e)}).observe(t,{childList:!0}),Ot(l)}var B=a(l()),Dt=()=>(f("Render <Main />"),B.default.useEffect(()=>{(()=>{var l=Spicetify.Locale;function r(e){return e.replace(/[{0}{1}«»”“]/g,"").trim()}if(l){r(l.get("playlist.a11y.play")||""),r(l.get("playlist.a11y.pause")||"");var n=l.get("play"),i=l.get("pause"),o=l.get("browse"),s=l.get("playback-control.skip-forward"),c=l.get("playback-control.skip-back"),u=l.get("buddy-feed.friend-activity"),d=l.get("tracklist.a11y.play")||"",m=l.get("view.web-player-home");let e,t;["zh-CN","zh-TW","am","fi"].includes(l.getLocale())?[e,t]=d.split("{1}"):[e,t]=d.split("{0}"),e=r(e),t=r(t);var d=l.get("playback-control.enable-repeat"),p=l.get("playback-control.enable-repeat-one"),l=l.get("playback-control.disable-repeat"),f="lucid_button_styles";let a=document.getElementById(f);a||((a=document.createElement("style")).id=f,document.head.appendChild(a)),a.innerHTML=`
.main-repeatButton-button[aria-checked="false"],
.player-controls__right button[aria-label*="${d}"]  span{
  -webkit-mask-image: var(--repeat-off-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/repeat-off.svg"));
  mask-image: var(--repeat-off-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/repeat-off.svg"));
  background-color: var(--spice-subtext);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="mixed"],
.player-controls__right button[aria-label*="${l}"] span {
  -webkit-mask-image: var(--repeat-mixed-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/repeat-mixed.svg"));
  mask-image: var(--repeat-mixed-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/repeat-mixed.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="true"],
.player-controls__right button[aria-label*="${p}"] span {
  -webkit-mask-image: var(--repeat-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/repeat.svg"));
  mask-image: var(--repeat-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/repeat.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.player-controls__right button[aria-label*="${l}"] svg,
.player-controls__right button[aria-label*="${d}"] svg {
  transform: scale(1.15);
}

.player-controls__right button[aria-label*="${l}"] svg,
.player-controls__right button[aria-label*="${d}"] svg {
  visibility: hidden;
  opacity: 0;
}

.main-repeatButton-button {
  transform: scale(0.65) !important;
}

.player-controls__buttons>button[aria-label*="${n}"] span,
.main-playButton-button[aria-label*="${n}"],
.main-playButton-PlayButton>button[aria-label*="${n}"]{
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--play-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/play.svg")) !important;
  mask-image: var(--play-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/play.svg")) !important;
}

.main-playButton-button[aria-label*="${i}"],
.main-playButton-PlayButton>button[aria-label*="${i}"],
.main-playPauseButton-button[aria-label*="${i}"],
.player-controls__buttons>button[aria-label*="${i}"] span {
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--pause-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/pause.svg")) !important;
  mask-image: var(--pause-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/pause.svg")) !important;
}

.Root__globalNav button:is([aria-label="Clear search field"]) {
  background-color: transparent !important;
  border: none !important;
}

button[aria-label="${o}"] path {
  display: none !important;
}

button[aria-label="${o}"] svg {
  -webkit-mask-size: contain;
  mask-size: contain;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-image: var(--compass-outline-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/compass-outline.svg"));
  mask-image: var(--compass-outline-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/compass-outline.svg"));
  background-color: var(--spice-subtext) !important;
  scale: 1.25;
}

.main-repeatButton-button[aria-label="${d}"],
.main-repeatButton-button[aria-label="${l}"],
.main-repeatButton-button[aria-label="${p}"],
{
scale: 0.75 !important;
background-color: var(--spice-subtext) !important;
color: var(--spice-subtext);

svg {
  display: none;
}
}

.player-controls__buttons>button[aria-label*="${n}"] span,
.player-controls__buttons>button[aria-label*="${i}"] span{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  aspect-ratio: 1/1;
}

.main-playPauseButton-button,
.player-controls button[aria-label="${c}"],
.player-controls button[aria-label="${s}"]
{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  min-height: 1rem;
  min-width: 1rem;
  aspect-ratio: 1/1;
  border-radius: 0 !important;
  border: none !important;
  height: var(--button-size, 24px);
  width: var(--button-size, 24px);
  
  svg,
  span {
    display: none;
    visibility: hidden;
  }
}

.player-controls__buttons>button[aria-label*="${n}"] span svg,
.player-controls__buttons>button[aria-label*="${i}"] span svg {
  display: none;
  visibility: hidden;
}

.player-controls button[aria-label="${c}"] span,
.player-controls button[aria-label="${s}"] span {
  opacity: 0;
}

.player-controls button[aria-label="${c}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--prev-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/prev.svg"));
  mask-image: var(--prev-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/prev.svg"));
}

.player-controls button[aria-label="${s}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--next-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/next.svg"));
  mask-image: var(--next-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/next.svg"));
}

button[aria-label="${u}"]>path {
  display: none;
}

.main-actionButtons>div>button[aria-label="${u}"] svg,
.main-actionButtons>button[aria-label="${u}"] svg {
  -webkit-mask-size: contain;
  mask-size: contain;
  -webkit-mask-position: center;
  mask-position: center;
  background-color: var(--spice-subtext) !important;
  -webkit-mask-image: var(--people-team-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/people-team.svg"));
  mask-image: var(--people-team-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/people-team.svg"));
}

.main-yourLibraryX-navLink[aria-label="${m}"] svg,
button[aria-label="${m}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-outline-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/home-outline.svg"));
  -webkit-mask-image: var(--home-outline-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/home-outline.svg"));
  background-color: var(--spice-subtext) !important;
}


.main-yourLibraryX-navLink[aria-label="${m}"].active svg,
.main-globalNav-navLinkActive[aria-label="${m}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-filled-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/home-filled.svg"));
  -webkit-mask-image: var(--home-filled-icon, url("https://sanooj.is-a.dev/Spicetify-Lucid/assets/icons/home-filled.svg"));
  background-color: var(--spice-text) !important;
}

.main-yourLibraryX-navLink[aria-label="${m}"].active svg {
  path {
display: none !important;
  }

  background-color: var(--spice-accent) !important;
}

#context-menu ul[aria-label*="Add to playlist menu"] {
  p {
max-width: 10rem;
  }
}
`}})(),(()=>{let e=document.getElementById("lucid-background-style");e||((e=document.createElement("style")).id="lucid-background-style",document.head.appendChild(e));var t=document.querySelector("#lyrics-cinema"),t=(t&&jt(t,"#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container",e,6),document.querySelector("#main .Root > div:last-child"));t&&jt(t,'.Root div[data-testid="fullscreen-mode-container"], .Root .npv-main-container',e,15)})()},[]),(()=>{let a=$t.default.useRef(null);$t.default.useEffect(()=>{let e=()=>{var e,t;document.getElementById("lucid-under-main-view")||((e=document.createElement("div")).id="lucid-under-main-view",e.className="lucid-under-main-view",(t=document.querySelector(".main-view-container"))&&t.prepend(e),a.current=e,a.current&&Spicetify.ReactDOM.createRoot(a.current).render($t.default.createElement(Bt,null)))},t=(e(),Spicetify.Platform.History.listen(()=>{e()}));return()=>{t()}},[])})(),B.default.createElement(B.default.Fragment,null,B.default.createElement("div",{id:"state"},B.default.createElement(qe,null)),B.default.createElement("div",{id:"background-container",className:"background-container",style:{containerType:"normal"}},B.default.createElement(Qe,null)),B.default.createElement(tt,null,B.default.createElement("div",{id:"modal-container",className:"modal-container",style:{containerType:"normal"}},B.default.createElement(xt,null),B.default.createElement(rt,null))),B.default.createElement("div",null,B.default.createElement(_t,null)))),$=a(l()),Ft="https://github.com/sanoojes/Spicetify-Lucid/issues",Vt=({error:e})=>{let[t,a]=$.default.useState(!1),l=$.default.useRef(null),r="";r=e instanceof Error?e.message:JSON.stringify(e,null,2);return $.default.createElement("div",{style:{width:"50vw"}},$.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},$.default.createElement("span",{style:{margin:"auto 0"}},$.default.createElement("p",null,"Oops! Lucid theme encountered an error. Please"," ",$.default.createElement("a",{href:Ft,target:"_blank",rel:"noopener noreferrer"},"report an issue here"))),$.default.createElement("div",null,$.default.createElement("button",{type:"button",onClick:()=>a(!t),className:"lucid-error-button"},t?"Hide Details":"Show Details"),$.default.createElement("button",{type:"button",onClick:()=>{l.current&&(navigator.clipboard.writeText(l.current.textContent||""),Spicetify.showNotification("Error details copied!",!1,2e3))},className:"lucid-copy-button",style:{marginLeft:"8px"}},"Copy Error"))),t&&$.default.createElement("pre",{style:{whiteSpace:"pre-wrap"},ref:l},r))},Tt=a(l()),zt=async function(){try{for(;!(null!=Spicetify&&Spicetify.showNotification&&null!=Spicetify&&Spicetify.Player&&null!=Spicetify&&Spicetify.React&&null!=Spicetify&&Spicetify.Platform);)await new Promise(e=>setTimeout(e,100));let e=document.getElementById("lucid-main");e||((e=document.createElement("div")).id="lucid-main",null!=(t=document.getElementById("main"))&&t.prepend(e)),e&&!e.hasChildNodes()&&Spicetify.ReactDOM.createRoot(e).render(Tt.default.createElement(Dt,null)),console.log("%c Lucid ignited! 🚀","font-weight: bold; font-size: 1.25rem; color: #2196F3; padding: 0.5rem 0;")}catch(e){k("Error:",t=e),Spicetify.showNotification($.default.createElement(Vt,{error:t}),!0)}var t};(async()=>{await zt()})()})();